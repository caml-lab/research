{"title": "Cutpaste: Self-supervised learning for anomaly detection and localization", "abstract": "We aim at constructing a high performance model for defect detection that detects unknown anomalous patterns of an image without anomalous data. To this end, we propose a two-stage framework for building anomaly detectors using normal training data only. We first learn self-supervised deep representations and then build a generative one-class classifier on learned representations. We learn representations by classifying normal data from the CutPaste, a simple data augmentation strategy that cuts an image patch and pastes at a random location of a large image. Our empirical study on MVTec anomaly detection dataset demonstrates the proposed algorithm is general to be able to detect various types of real-world defects. We bring the improvement upon previous arts by 3.1 AUCs when learning representations from scratch. By transfer learning on pretrained representations on ImageNet, we achieve a new state-of-theart 96.6 AUC. Lastly, we extend the framework to learn and extract representations from patches to allow localizing defective areas without annotations during training.", "authors": ["Chun-Liang Li", " Kihyuk Sohn", " Jinsung Yoon", " Tomas Pfister"], "pdf_url": "https://arxiv.org/abs/2104.04015", "list_table_and_caption": [{"table": "<table><tbody><tr><td colspan=\"2\" rowspan=\"2\">Category</td><td>DOCC</td><td>U-Student</td><td>P-SVDD</td><td rowspan=\"2\">Rotation</td><td rowspan=\"2\">Cutout</td><td rowspan=\"2\">Scar</td><td rowspan=\"2\">CutPaste</td><td>CutPaste</td><td>CutPaste</td><td rowspan=\"2\">Ensemble</td></tr><tr><td>[45]</td><td>[6]</td><td>[61]</td><td>(scar)</td><td>(3-way)</td></tr><tr><td rowspan=\"6\">texture</td><td>carpet</td><td>90.6</td><td>95.3</td><td>92.9</td><td>29.7\\pm 1.4</td><td>35.3\\pm 2.3</td><td>92.7\\pm 0.4</td><td>67.9\\pm 1.8</td><td>94.6\\pm 0.6</td><td>93.1\\pm 1.1</td><td>93.9</td></tr><tr><td>grid</td><td>52.4</td><td>98.7</td><td>94.6</td><td>60.5\\pm 7.0</td><td>57.5\\pm 3.0</td><td>74.4\\pm 2.5</td><td>99.9\\pm 0.1</td><td>95.5\\pm 0.3</td><td>99.9\\pm 0.1</td><td>100.0</td></tr><tr><td>leather</td><td>78.3</td><td>93.4</td><td>90.9</td><td>55.2\\pm 1.4</td><td>67.7\\pm 1.5</td><td>99.9\\pm 0.1</td><td>99.7\\pm 0.1</td><td>100.0 \\pm 0.0</td><td>100.0 \\pm 0.0</td><td>100.0</td></tr><tr><td>tile</td><td>96.5</td><td>95.8</td><td>97.8</td><td>70.1\\pm 1.9</td><td>71.8\\pm 4.0</td><td>96.7\\pm 0.9</td><td>95.9\\pm 1.0</td><td>89.4\\pm 2.8</td><td>93.4\\pm 1.0</td><td>94.6</td></tr><tr><td>wood</td><td>91.6</td><td>95.5</td><td>96.5</td><td>95.8\\pm 1.1</td><td>92.0\\pm 0.8</td><td>98.9\\pm 0.2</td><td>94.9\\pm 0.5</td><td>98.7\\pm 0.3</td><td>98.6\\pm 0.5</td><td>99.1</td></tr><tr><td>average</td><td>81.9</td><td>95.7</td><td>94.5</td><td>62.3\\pm 2.6</td><td>64.9\\pm 2.3</td><td>92.5\\pm 0.8</td><td>91.7\\pm 0.7</td><td>95.7\\pm 0.8</td><td>97.0\\pm 0.5</td><td>97.5</td></tr><tr><td rowspan=\"11\">object</td><td>bottle</td><td>99.6</td><td>96.7</td><td>98.6</td><td>95.0\\pm 0.7</td><td>88.7\\pm 0.8</td><td>98.5\\pm 0.2</td><td>99.2\\pm 0.2</td><td>98.0\\pm 0.5</td><td>98.3\\pm 0.5</td><td>98.2</td></tr><tr><td>cable</td><td>90.9</td><td>82.3</td><td>90.3</td><td>85.3\\pm 0.8</td><td>80.2\\pm 1.4</td><td>78.3\\pm 1.7</td><td>87.1\\pm 0.8</td><td>78.8\\pm 2.9</td><td>80.6\\pm 0.5</td><td>81.2</td></tr><tr><td>capsule</td><td>91.0</td><td>92.8</td><td>76.7</td><td>71.8\\pm 1.4</td><td>69.5\\pm 1.1</td><td>82.9\\pm 0.7</td><td>87.9\\pm 0.7</td><td>95.3\\pm 0.8</td><td>96.2\\pm 0.5</td><td>98.2</td></tr><tr><td>hazelnut</td><td>95.0</td><td>91.4</td><td>92.0</td><td>83.6\\pm 0.8</td><td>69.7\\pm 1.3</td><td>98.9\\pm 0.2</td><td>91.3\\pm 0.6</td><td>96.7\\pm 0.4</td><td>97.3\\pm 0.3</td><td>98.3</td></tr><tr><td>metal nut</td><td>85.2</td><td>94.0</td><td>94.0</td><td>72.7\\pm 0.5</td><td>84.6\\pm 0.7</td><td>86.9\\pm 1.5</td><td>96.8\\pm 0.5</td><td>97.9\\pm 0.2</td><td>99.3\\pm 0.2</td><td>99.9</td></tr><tr><td>pill</td><td>80.4</td><td>86.7</td><td>86.1</td><td>79.2\\pm 1.4</td><td>78.7\\pm 0.7</td><td>82.2\\pm 1.4</td><td>93.4\\pm 0.9</td><td>85.8\\pm 1.3</td><td>92.4\\pm 1.3</td><td>94.9</td></tr><tr><td>screw</td><td>86.9</td><td>87.4</td><td>81.3</td><td>35.8\\pm 2.9</td><td>17.6\\pm 4.4</td><td>11.3\\pm 2.2</td><td>54.4\\pm 1.7</td><td>83.7\\pm 0.7</td><td>86.3\\pm 1.0</td><td>88.7</td></tr><tr><td>toothbrush</td><td>96.4</td><td>98.6</td><td>100.0</td><td>99.1\\pm 0.2</td><td>98.1\\pm 0.6</td><td>94.8\\pm 1.0</td><td>99.2\\pm 0.2</td><td>96.7\\pm 0.4</td><td>98.3\\pm 0.9</td><td>99.4</td></tr><tr><td>transistor</td><td>90.8</td><td>83.6</td><td>91.5</td><td>88.9\\pm 0.4</td><td>82.5\\pm 1.2</td><td>92.0\\pm 0.7</td><td>96.4\\pm 0.7</td><td>91.1\\pm 0.6</td><td>95.5\\pm 0.5</td><td>96.1</td></tr><tr><td>zipper</td><td>92.4</td><td>95.8</td><td>97.9</td><td>74.3\\pm 1.6</td><td>75.7\\pm 1.0</td><td>86.8\\pm 0.9</td><td>99.4\\pm 0.1</td><td>99.5\\pm 0.1</td><td>99.4\\pm 0.2</td><td>99.9</td></tr><tr><td>average</td><td>90.9</td><td>90.9</td><td>90.8</td><td>78.6\\pm 1.1</td><td>74.5\\pm 1.3</td><td>81.3\\pm 1.1</td><td>90.5\\pm 0.6</td><td>92.4\\pm 0.8</td><td>94.3\\pm 0.6</td><td>95.5</td></tr><tr><td colspan=\"2\">average</td><td>87.9</td><td>92.5</td><td>92.1</td><td>73.1\\pm 1.6</td><td>71.3\\pm 1.6</td><td>85.0\\pm 1.0</td><td>90.9\\pm 0.7</td><td>93.5\\pm 0.8</td><td>95.2\\pm 0.6</td><td>96.1</td></tr></tbody></table>", "caption": "Table 1: Anomaly detection performance on MVTec AD dataset [5]. We report AUCs of representations trained to classify CutPaste, CutPaste (scar), both (3-way), and baseline augmentations such as rotation, Cutout, or scar.For comparison, we report those of deep one-class classifier [45], uninformed student [6] and patch-SVDD [61]. We report mean and standard error tested with 5 random seeds. Lastly, we report the AUC using ensemble of 5 CutPaste (3-way) models. The best performing model and those within standard error are bold-faced.", "list_citation_info": ["[5] Paul Bergmann, Michael Fauser, David Sattlegger, and Carsten Steger. Mvtec ad\u2013a comprehensive real-world dataset for unsupervised anomaly detection. In CVPR, 2019.", "[45] Lukas Ruff, Jacob R Kauffmann, Robert A Vandermeulen, Gr\u00e9goire Montavon, Wojciech Samek, Marius Kloft, Thomas G Dietterich, and Klaus-Robert M\u00fcller. A unifying review of deep and shallow anomaly detection. arXiv preprint arXiv:2009.11732, 2020.", "[61] Jihun Yi and Sungroh Yoon. Patch svdd: Patch-level svdd for anomaly detection and segmentation. arXiv preprint arXiv:2006.16067, 2020.", "[6] Paul Bergmann, Michael Fauser, David Sattlegger, and Carsten Steger. Uninformed students: Student-teacher anomaly detection with discriminative latent embeddings. In CVPR, 2020."]}, {"table": "<table><tbody><tr><td colspan=\"2\">Category</td><td>FCDD [32]</td><td>P-SVDD [61]</td><td>CutPaste (3-way)</td></tr><tr><td rowspan=\"6\">texture</td><td>carpet</td><td>96</td><td>92.6</td><td>98.3\\pm 0.0</td></tr><tr><td>grid</td><td>91</td><td>96.2</td><td>97.5\\pm 0.1</td></tr><tr><td>leather</td><td>98</td><td>97.4</td><td>99.5\\pm 0.0</td></tr><tr><td>tile</td><td>91</td><td>91.4</td><td>90.5\\pm 0.2</td></tr><tr><td>wood</td><td>88</td><td>90.8</td><td>95.5\\pm 0.1</td></tr><tr><td>average</td><td>93</td><td>93.7</td><td>96.3\\pm 0.1</td></tr><tr><td rowspan=\"11\">object</td><td>bottle</td><td>97</td><td>98.1</td><td>97.6\\pm 0.1</td></tr><tr><td>cable</td><td>90</td><td>96.8</td><td>90.0\\pm 0.2</td></tr><tr><td>capsule</td><td>93</td><td>95.8</td><td>97.4\\pm 0.1</td></tr><tr><td>hazelnut</td><td>95</td><td>97.5</td><td>97.3\\pm 0.1</td></tr><tr><td>metal nut</td><td>94</td><td>98.0</td><td>93.1\\pm 0.4</td></tr><tr><td>pill</td><td>81</td><td>95.1</td><td>95.7\\pm 0.1</td></tr><tr><td>screw</td><td>86</td><td>95.7</td><td>96.7\\pm 0.1</td></tr><tr><td>toothbrush</td><td>94</td><td>98.1</td><td>98.1\\pm 0.0</td></tr><tr><td>transistor</td><td>88</td><td>97.0</td><td>93.0\\pm 0.2</td></tr><tr><td>zipper</td><td>92</td><td>95.1</td><td>99.3\\pm 0.0</td></tr><tr><td>average</td><td>91</td><td>96.7</td><td>95.8\\pm 0.1</td></tr><tr><td colspan=\"2\">average</td><td>92</td><td>95.7</td><td>96.0\\pm 0.1</td></tr></tbody></table>", "caption": "Table 2: Pixel-wise localization AUC on MVTec dataset. The best and models within standard error are bold-faced.", "list_citation_info": ["[32] Philipp Liznerski, Lukas Ruff, Robert A Vandermeulen, Billy Joe Franks, Marius Kloft, and Klaus-Robert M\u00fcller. Explainable deep one-class classification. arXiv preprint arXiv:2007.01760, 2020.", "[61] Jihun Yi and Sungroh Yoon. Patch svdd: Patch-level svdd for anomaly detection and segmentation. arXiv preprint arXiv:2006.16067, 2020."]}, {"table": "<table><tbody><tr><td colspan=\"2\" rowspan=\"2\">Category</td><td colspan=\"2\">Pool</td><td colspan=\"2\">Level-7</td></tr><tr><td>Pretrain</td><td>Finetune</td><td>Pretrain</td><td>Finetune</td></tr><tr><td rowspan=\"6\">texture</td><td>carpet</td><td>98.3</td><td>100.0\\pm 0.0</td><td>97.6</td><td>100.0\\pm 0.0</td></tr><tr><td>grid</td><td>96.4</td><td>98.8\\pm 0.1</td><td>98.2</td><td>99.1\\pm 0.0</td></tr><tr><td>leather</td><td>100.0</td><td>100.0\\pm 0.0</td><td>100.0</td><td>100.0\\pm 0.0</td></tr><tr><td>tile</td><td>99.9</td><td>98.9\\pm 0.2</td><td>99.9</td><td>99.8\\pm 0.2</td></tr><tr><td>wood</td><td>99.7</td><td>99.8\\pm 0.0</td><td>99.6</td><td>99.8\\pm 0.0</td></tr><tr><td>average</td><td>98.9</td><td>99.5\\pm 0.0</td><td>99</td><td>99.7\\pm 0.0</td></tr><tr><td rowspan=\"11\">object</td><td>bottle</td><td>99.8</td><td>100.0\\pm 0.0</td><td>100.0</td><td>100.0\\pm 0.0</td></tr><tr><td>cable</td><td>91.2</td><td>93.9\\pm 0.1</td><td>96.5</td><td>96.2\\pm 0.3</td></tr><tr><td>capsule</td><td>93</td><td>94.3\\pm 0.3</td><td>94.7</td><td>95.4\\pm 0.1</td></tr><tr><td>hazelnut</td><td>96.6</td><td>99.7\\pm 0.0</td><td>100.0</td><td>99.9\\pm 0.0</td></tr><tr><td>metalnut</td><td>94.3</td><td>98.7\\pm 0.1</td><td>97.7</td><td>98.6\\pm 0.0</td></tr><tr><td>pill</td><td>81.9</td><td>91.3\\pm 0.2</td><td>91</td><td>93.3\\pm 0.2</td></tr><tr><td>screw</td><td>86.3</td><td>86\\pm 0.1</td><td>92.0</td><td>86.6\\pm 0.2</td></tr><tr><td>toothbrush</td><td>89.3</td><td>92.8\\pm 0.2</td><td>90.3</td><td>90.7\\pm 0.1</td></tr><tr><td>transistor</td><td>94.6</td><td>95.6\\pm 0.2</td><td>97.5</td><td>97.5\\pm 0.2</td></tr><tr><td>zipper</td><td>95.6</td><td>99.9\\pm 0.0</td><td>97</td><td>99.9\\pm 0.1</td></tr><tr><td>average</td><td>92.3</td><td>95.2\\pm 0.1</td><td>95.7</td><td>95.8\\pm 0.1</td></tr><tr><td colspan=\"2\">average</td><td>94.5</td><td>96.6\\pm 0.1</td><td>96.8</td><td>97.1\\pm 0.0</td></tr></tbody></table>", "caption": "Table 3: Detection performance on MVTec dataset using representations of EfficientNet (B4) [55] pretrained on ImageNet [17] and fine-tuned by the CutPaste (3-way). The number is bold when it is better than its pretrained or finetuned counterpart under the same feature (pool v.s. level-7). ", "list_citation_info": ["[17] Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei. ImageNet: A large-scale hierarchical image database. In CVPR, 2009.", "[55] Mingxing Tan and Quoc Le. Efficientnet: Rethinking model scaling for convolutional neural networks. In ICML, 2019."]}, {"table": "<table><tbody><tr><th rowspan=\"2\">Category</th><td rowspan=\"2\">Cutout</td><td><p>Cutout</p></td><td><p>Cutout</p></td><td rowspan=\"2\">Confetti</td><td rowspan=\"2\">CutPaste</td></tr><tr><td><p>(Mean)</p></td><td><p>(Color)</p></td></tr><tr><th>texture</th><td><p>64.9\\pm 2.3</p></td><td><p>65.5\\pm 1.8</p></td><td><p>70.5\\pm 2.2</p></td><td><p>80.1\\pm 2.3</p></td><td><p>91.7\\pm 0.7</p></td></tr><tr><th>object</th><td><p>74.5\\pm 1.3</p></td><td><p>78.1\\pm 1.1</p></td><td><p>78.9\\pm 1.0</p></td><td><p>76.7\\pm 0.3</p></td><td><p>90.5\\pm 0.6</p></td></tr><tr><th>all</th><td><p>71.3\\pm 1.7</p></td><td><p>73.9\\pm 1.3</p></td><td><p>76.1\\pm 1.4</p></td><td><p>77.8\\pm 1.5</p></td><td><p>90.9\\pm 0.7</p></td></tr></tbody></table>", "caption": "Table 4: Detection AUCs of representations trained to predict Cutout, with mean pixel value, with random color, Confetti noise [32], or the proposed CutPaste.", "list_citation_info": ["[32] Philipp Liznerski, Lukas Ruff, Robert A Vandermeulen, Billy Joe Franks, Marius Kloft, and Klaus-Robert M\u00fcller. Explainable deep one-class classification. arXiv preprint arXiv:2007.01760, 2020."]}]}