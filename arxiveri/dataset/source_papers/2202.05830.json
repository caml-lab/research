{"title": "Learning Fast Samplers for Diffusion Models by Differentiating Through Sample Quality", "abstract": "Diffusion models have emerged as an expressive family of generative models rivaling GANs in sample quality and autoregressive models in likelihood scores. Standard diffusion models typically require hundreds of forward passes through the model to generate a single high-fidelity sample. We introduce Differentiable Diffusion Sampler Search (DDSS): a method that optimizes fast samplers for any pre-trained diffusion model by differentiating through sample quality scores. We also present Generalized Gaussian Diffusion Models (GGDM), a family of flexible non-Markovian samplers for diffusion models. We show that optimizing the degrees of freedom of GGDM samplers by maximizing sample quality scores via gradient descent leads to improved sample quality. Our optimization procedure backpropagates through the sampling process using the reparametrization trick and gradient rematerialization. DDSS achieves strong results on unconditional image generation across various datasets (e.g., FID scores on LSUN church 128x128 of 11.6 with only 10 inference steps, and 4.82 with 20 steps, compared to 51.1 and 14.9 with strongest DDPM/DDIM baselines). Our method is compatible with any pre-trained diffusion model without fine-tuning or re-training required.", "authors": ["Daniel Watson", " William Chan", " Jonathan Ho", " Mohammad Norouzi"], "pdf_url": "https://arxiv.org/abs/2202.05830", "list_table_and_caption": [{"table": "<table><thead><tr><th><p>Sampler \\setminus K</p></th><th>5</th><th>10</th><th>15</th><th>20</th><th>25</th></tr></thead><tbody><tr><th><p>DDPM (linear stride)</p></th><td>84.27 / 5.396</td><td>43.39 / 7.034</td><td>31.40 / 7.609</td><td>25.94 / 7.879</td><td>22.60 / 8.043</td></tr><tr><th><p>DDPM (quadratic stride)</p></th><td>76.25 / 5.435</td><td>42.03 / 6.965</td><td>27.78 / 7.714</td><td>20.225 / 8.128</td><td>16.17 / 8.350</td></tr><tr><th><p>DDIM (linear stride)</p></th><td>44.41 / 6.750</td><td>19.11 / 7.965</td><td>14.06 / 8.190</td><td>11.82 / 8.420</td><td>10.52 / 8.512</td></tr><tr><th><p>DDIM (quadratic stride)</p></th><td>32.66 / 7.090</td><td>13.62 / 8.190</td><td>9.318 / 8.495</td><td>7.500 / 8.641</td><td>6.560 / 8.759</td></tr><tr><th><p>GGDM +PRED+TIME</p></th><td>13.77 / 8.520</td><td>8.227 / 8.903</td><td>6.115 / 9.050</td><td>4.722 / 9.261</td><td>4.250 / 9.186</td></tr></tbody></table>", "caption": "Table 1: FID and IS scores for DDSS against baseline methods for a DDPM trained on CIFAR10 with the L_{\\textrm{simple}} objective proposed by (Ho et al., 2020). FID scores (lower is better) are the numbers at the left of each entry, and IS scores (higher is better) are at the right.", "list_citation_info": ["Ho et al. (2020) Jonathan Ho, Ajay Jain, and Pieter Abbeel. Denoising Diffusion Probabilistic Models. NeurIPS, 2020."]}, {"table": "<table><thead><tr><th><p>Sampler \\setminus K</p></th><th>5</th><th>10</th><th>15</th><th>20</th><th>25</th></tr></thead><tbody><tr><th><p>DDPM (linear stride)</p></th><td>122.0 / 5.878</td><td>58.78 / 10.67</td><td>39.30 / 13.22</td><td>31.36 / 14.72</td><td>26.36 / 15.71</td></tr><tr><th><p>DDPM (quadratic stride)</p></th><td>394.8 / 1.351</td><td>129.5 / 5.997</td><td>80.10 / 9.595</td><td>61.34 / 11.60</td><td>49.60 / 13.01</td></tr><tr><th><p>DDIM (linear stride)</p></th><td>135.4 / 5.898</td><td>40.70 / 12.225</td><td>28.54 / 13.99</td><td>24.225 / 14.75</td><td>22.13 / 15.16</td></tr><tr><th><p>DDIM (quadratic stride)</p></th><td>409.1 / 1.380</td><td>148.6 / 5.533</td><td>67.65 / 9.842</td><td>45.60 / 11.99</td><td>36.11 / 13.225</td></tr><tr><th><p>GGDM +PRED+TIME</p></th><td>55.14 / 12.90</td><td>37.32 / 14.76</td><td>24.69 / 17.225</td><td>20.69 /17.92</td><td>18.40 / 18.12</td></tr></tbody></table>", "caption": "Table 2: FID / IS scores for DDSS against baseline methods for a DDPM trained on ImageNet 64x64 with the L_{\\textrm{hybrid}} objective proposed by Nichol &amp; Dhariwal (2021).", "list_citation_info": ["Nichol & Dhariwal (2021) Alex Nichol and Prafulla Dhariwal. Improved denoising diffusion probabilistic models. arXiv preprint arXiv:2102.09672, 2021."]}]}