{"title": "Gaussian process meta few-shot classifier learning via linear discriminant Laplace approximation", "abstract": "The meta learning few-shot classification is an emerging problem in machine learning that received enormous attention recently, where the goal is to learn a model that can quickly adapt to a new task with only a few labeled data. We consider the Bayesian Gaussian process (GP) approach, in which we meta-learn the GP prior, and the adaptation to a new task is carried out by the GP predictive model from the posterior inference. We adopt the Laplace posterior approximation, but to circumvent the iterative gradient steps for finding the MAP solution, we introduce a novel linear discriminant analysis (LDA) plugin as a surrogate for the MAP solution. In essence, the MAP solution is approximated by the LDA estimate, but to take the GP prior into account, we adopt the prior-norm adjustment to estimate LDA's shared variance parameters, which ensures that the adjusted estimate is consistent with the GP prior. This enables closed-form differentiable GP posteriors and predictive distributions, thus allowing fast meta training. We demonstrate considerable improvement over the previous approaches.", "authors": ["Minyoung Kim", " Timothy Hospedales"], "pdf_url": "https://arxiv.org/abs/2111.05392", "list_table_and_caption": [{"table": "<table><thead><tr><th rowspan=\"2\">Methods</th><th colspan=\"2\">Conv-4</th><th colspan=\"2\">ResNet-10</th></tr><tr><th>1-shot</th><th>5-shot</th><th>1-shot</th><th>5-shot</th></tr></thead><tbody><tr><th>Feature Transfer</th><td>46.19\\pm 0.64</td><td>68.40\\pm 0.79</td><td>63.64\\pm 0.91</td><td>81.27\\pm 0.57</td></tr><tr><th>Baseline++ [Chen et al., 2019]</th><td>61.75\\pm 0.95</td><td>78.51\\pm 0.59</td><td>69.55\\pm 0.89</td><td>85.17\\pm 0.50</td></tr><tr><th>MatchingNet [Vinyals et al., 2016]</th><td>60.19\\pm 1.02</td><td>75.11\\pm 0.35</td><td>71.29\\pm 0.87</td><td>83.47\\pm 0.58</td></tr><tr><th>ProtoNet [Snell et al., 2017]</th><td>52.52\\pm 1.90</td><td>75.93\\pm 0.46</td><td>{\\bf 73.22\\pm 0.92}</td><td>85.01\\pm 0.52</td></tr><tr><th>MAML [Finn et al., 2017]</th><td>56.11\\pm 0.69</td><td>74.84\\pm 0.62</td><td>70.32\\pm 0.99</td><td>80.93\\pm 0.71</td></tr><tr><th>RelationNet [Sung et al., 2018]</th><td>62.52\\pm 0.34</td><td>78.22\\pm 0.07</td><td>70.47\\pm 0.99</td><td>83.70\\pm 0.55</td></tr><tr><th>SimpleShot [Wang et al., 2019]</th><td>-</td><td>-</td><td>53.78\\pm 0.21</td><td>71.41\\pm 0.17</td></tr><tr><th>GPDKT{}^{\\textrm{CosSim}} [Patacchiola et al., 2020]</th><td>63.37\\pm 0.19</td><td>77.73\\pm 0.26</td><td>70.81\\pm 0.52</td><td>83.26\\pm 0.50</td></tr><tr><th>GPDKT{}^{\\textrm{BNCosSim}} [Patacchiola et al., 2020]</th><td>62.96\\pm 0.62</td><td>77.76\\pm 0.62</td><td>72.27\\pm 0.30</td><td>85.64\\pm 0.29</td></tr><tr><th>GPLDLA (Ours)</th><td>{\\bf 63.40\\pm 0.14}</td><td>{\\bf 78.86\\pm 0.35}</td><td>71.30\\pm 0.16</td><td>{\\bf 86.38\\pm 0.15}</td></tr></tbody></table>", "caption": "Table 1: Average accuracies and standard deviations on the CUB dataset. Best results are boldfaced.", "list_citation_info": ["Sung et al. [2018] Flood Sung, Yongxin Yang, Li Zhang, Tao Xiang, Philip H. S. Torr, and Timothy M. Hospedales. Learning to Compare: Relation Network for Few-Shot Learning. In IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), June 2018.", "Finn et al. [2017] Chelsea Finn, Pieter Abbeel, and Sergey Levine. Model-agnostic meta-learning for fast adaptation of deep networks. In International Conference on Machine Learning, 2017.", "Snell et al. [2017] Jake Snell, Kevin Swersky, and Richard S. Zemel. Prototypical networks for few-shot learning. CoRR, abs/1703.05175, 2017. URL http://arxiv.org/abs/1703.05175.", "Chen et al. [2019] Wei-Yu Chen, Yen-Cheng Liu, Zsolt Kira, Yu-Chiang Wang, and Jia-Bin Huang. A closer look at few-shot classification. In International Conference on Learning Representations, 2019.", "Vinyals et al. [2016] Oriol Vinyals, Charles Blundell, Timothy Lillicrap, Koray Kavukcuoglu, and Daan Wierstra. Matching networks for one shot learning. In Advances in Neural Information Processing Systems, 2016.", "Patacchiola et al. [2020] Massimiliano Patacchiola, Jack Turner, Elliot J. Crowley, and Amos Storkey. Bayesian meta-learning for the few-shot setting via deep kernels. In Advances in Neural Information Processing Systems, 2020.", "Wang et al. [2019] Yan Wang, Wei-Lun Chao, Kilian Q. Weinberger, and Laurens van der Maaten. SimpleShot: Revisiting Nearest-Neighbor Classification for Few-Shot Learning. arXiv preprint arXiv:1911.04623, 2019."]}, {"table": "<table><thead><tr><th rowspan=\"2\">Methods</th><th colspan=\"2\">Conv-4</th><th colspan=\"2\">ResNet-18</th></tr><tr><th>1-shot</th><th>5-shot</th><th>1-shot</th><th>5-shot</th></tr></thead><tbody><tr><th>Feature Transfer</th><td>39.51\\pm 0.23</td><td>60.51\\pm 0.55</td><td>-</td><td>-</td></tr><tr><th>Baseline++ [Chen et al., 2019]</th><td>47.15\\pm 0.49</td><td>66.18\\pm 0.18</td><td>51.87\\pm 0.77</td><td>75.68\\pm 0.63</td></tr><tr><th>MatchingNet [Vinyals et al., 2016]</th><td>48.25\\pm 0.65</td><td>62.71\\pm 0.44</td><td>-</td><td>-</td></tr><tr><th>ProtoNet [Snell et al., 2017]</th><td>44.19\\pm 1.30</td><td>64.07\\pm 0.65</td><td>54.16\\pm 0.82</td><td>73.68\\pm 0.65</td></tr><tr><th>MAML [Finn et al., 2017]</th><td>45.39\\pm 0.49</td><td>61.58\\pm 0.53</td><td>-</td><td>-</td></tr><tr><th>RelationNet [Sung et al., 2018]</th><td>48.76\\pm 0.17</td><td>64.20\\pm 0.28</td><td>52.48\\pm 0.86</td><td>69.83\\pm 0.68</td></tr><tr><th>ML-LSTM [Ravi and Larochelle, 2017]</th><td>43.44\\pm 0.77</td><td>60.60\\pm 0.71</td><td>-</td><td>-</td></tr><tr><th>SNAIL [Mishra et al., 2018]</th><td>45.10</td><td>55.20</td><td>-</td><td>-</td></tr><tr><th>VERSA [Gordon et al., 2019]</th><td>48.53\\pm 1.84</td><td>67.37\\pm 0.86</td><td>-</td><td>-</td></tr><tr><th>LLAMA [Grant et al., 2018]</th><td>49.40\\pm 1.83</td><td>-</td><td>-</td><td>-</td></tr><tr><th>Meta-Mixture [Jerfel et al., 2019]</th><td>49.60\\pm 1.50</td><td>64.60\\pm 0.92</td><td>-</td><td>-</td></tr><tr><th>SimpleShot [Wang et al., 2019]</th><td>49.69\\pm 0.19</td><td>66.92\\pm 0.17</td><td>{\\bf 62.85\\pm 0.20}</td><td>{\\bf 80.02\\pm 0.14}</td></tr><tr><th>GPDKT{}^{\\textrm{CosSim}} [Patacchiola et al., 2020]</th><td>48.64\\pm 0.45</td><td>62.85\\pm 0.37</td><td>-</td><td>-</td></tr><tr><th>GPDKT{}^{\\textrm{BNCosSim}} [Patacchiola et al., 2020]</th><td>49.73\\pm 0.07</td><td>64.00\\pm 0.09</td><td>-</td><td>-</td></tr><tr><th>GPLDLA (Ours)</th><td>{\\bf 52.58\\pm 0.19}</td><td>{\\bf 69.59\\pm 0.16}</td><td>60.05\\pm 0.20</td><td>79.22\\pm 0.15</td></tr></tbody></table>", "caption": "Table 2: Results on the miniImageNet dataset. Best scores are boldfaced.", "list_citation_info": ["Sung et al. [2018] Flood Sung, Yongxin Yang, Li Zhang, Tao Xiang, Philip H. S. Torr, and Timothy M. Hospedales. Learning to Compare: Relation Network for Few-Shot Learning. In IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), June 2018.", "Finn et al. [2017] Chelsea Finn, Pieter Abbeel, and Sergey Levine. Model-agnostic meta-learning for fast adaptation of deep networks. In International Conference on Machine Learning, 2017.", "Snell et al. [2017] Jake Snell, Kevin Swersky, and Richard S. Zemel. Prototypical networks for few-shot learning. CoRR, abs/1703.05175, 2017. URL http://arxiv.org/abs/1703.05175.", "Wang et al. [2019] Yan Wang, Wei-Lun Chao, Kilian Q. Weinberger, and Laurens van der Maaten. SimpleShot: Revisiting Nearest-Neighbor Classification for Few-Shot Learning. arXiv preprint arXiv:1911.04623, 2019.", "Grant et al. [2018] Erin Grant, Chelsea Finn, Sergey Levine, Trevor Darrell, and Thomas Griffiths. Recasting Gradient-Based Meta-Learning as Hierarchical Bayes. In International Conference on Learning Representations, 2018.", "Jerfel et al. [2019] Ghassen Jerfel, Erin Grant, Thomas L. Griffiths, and Katherine Heller. Reconciling meta-learning and continual learning with online mixtures of tasks. In Advances in Neural Information Processing Systems, 2019.", "Patacchiola et al. [2020] Massimiliano Patacchiola, Jack Turner, Elliot J. Crowley, and Amos Storkey. Bayesian meta-learning for the few-shot setting via deep kernels. In Advances in Neural Information Processing Systems, 2020.", "Chen et al. [2019] Wei-Yu Chen, Yen-Cheng Liu, Zsolt Kira, Yu-Chiang Wang, and Jia-Bin Huang. A closer look at few-shot classification. In International Conference on Learning Representations, 2019.", "Ravi and Larochelle [2017] Sachin Ravi and Hugo Larochelle. Optimization as a Model for Few-Shot Learning. In International Conference on Learning Representations, 2017.", "Vinyals et al. [2016] Oriol Vinyals, Charles Blundell, Timothy Lillicrap, Koray Kavukcuoglu, and Daan Wierstra. Matching networks for one shot learning. In Advances in Neural Information Processing Systems, 2016.", "Mishra et al. [2018] Nikhil Mishra, Mostafa Rohaninejad, Xi Chen, and Pieter Abbeel. A Simple Neural Attentive Meta-Learner. In International Conference on Learning Representations, 2018.", "Gordon et al. [2019] Jonathan Gordon, John Bronskill, Matthias Bauer, Sebastian Nowozin, and Richard Turner. Meta-learning probabilistic inference for prediction. In International Conference on Learning Representations, 2019. URL https://openreview.net/forum?id=HkxStoC5F7."]}, {"table": "<table><thead><tr><th rowspan=\"2\">Methods</th><th colspan=\"2\">Conv-4</th><th colspan=\"2\">ResNet-18</th></tr><tr><th>1-shot</th><th>5-shot</th><th>1-shot</th><th>5-shot</th></tr></thead><tbody><tr><th>ProtoNet [Snell et al., 2017]</th><td>53.31\\pm 0.89</td><td>72.69\\pm 0.74</td><td>-</td><td>-</td></tr><tr><th>MAML [Finn et al., 2017]</th><td>51.67\\pm 1.81</td><td>70.30\\pm 1.75</td><td>-</td><td>-</td></tr><tr><th>RelationNet [Sung et al., 2018]</th><td>54.48\\pm 0.48</td><td>71.31\\pm 0.78</td><td>-</td><td>-</td></tr><tr><th>SimpleShot [Wang et al., 2019]</th><td>51.02\\pm 0.20</td><td>68.98\\pm 0.18</td><td>69.09\\pm 0.22</td><td>84.58\\pm 0.16</td></tr><tr><th>GPDKT{}^{\\textrm{CosSim}} [Patacchiola et al., 2020]</th><td>51.14\\pm 0.21</td><td>67.20\\pm 0.18</td><td>62.65\\pm 0.23</td><td>79.93\\pm 0.17</td></tr><tr><th>GPLDLA (Ours)</th><td>{\\bf 54.75\\pm 0.24}</td><td>{\\bf 72.93\\pm 0.26}</td><td>{\\bf 69.45\\pm 0.37}</td><td>{\\bf 85.16\\pm 0.19}</td></tr></tbody></table>", "caption": "Table 3: Results on the tieredImageNet dataset. Best scores are boldfaced.", "list_citation_info": ["Sung et al. [2018] Flood Sung, Yongxin Yang, Li Zhang, Tao Xiang, Philip H. S. Torr, and Timothy M. Hospedales. Learning to Compare: Relation Network for Few-Shot Learning. In IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), June 2018.", "Finn et al. [2017] Chelsea Finn, Pieter Abbeel, and Sergey Levine. Model-agnostic meta-learning for fast adaptation of deep networks. In International Conference on Machine Learning, 2017.", "Snell et al. [2017] Jake Snell, Kevin Swersky, and Richard S. Zemel. Prototypical networks for few-shot learning. CoRR, abs/1703.05175, 2017. URL http://arxiv.org/abs/1703.05175.", "Patacchiola et al. [2020] Massimiliano Patacchiola, Jack Turner, Elliot J. Crowley, and Amos Storkey. Bayesian meta-learning for the few-shot setting via deep kernels. In Advances in Neural Information Processing Systems, 2020.", "Wang et al. [2019] Yan Wang, Wei-Lun Chao, Kilian Q. Weinberger, and Laurens van der Maaten. SimpleShot: Revisiting Nearest-Neighbor Classification for Few-Shot Learning. arXiv preprint arXiv:1911.04623, 2019."]}, {"table": "<table><thead><tr><th rowspan=\"2\">Methods</th><th colspan=\"2\">OMNIGLOT\\toEMNIST</th><th colspan=\"2\">miniImageNet\\toCUB</th></tr><tr><th>1-shot</th><th>5-shot</th><th>1-shot</th><th>5-shot</th></tr></thead><tbody><tr><th>Feature Transfer</th><td>64.22\\pm 1.24</td><td>86.10\\pm 0.84</td><td>32.77\\pm 0.35</td><td>50.34\\pm 0.27</td></tr><tr><th>Baseline++ [Chen et al., 2019]</th><td>56.84\\pm 0.91</td><td>80.01\\pm 0.92</td><td>39.19\\pm 0.12</td><td>57.31\\pm 0.11</td></tr><tr><th>MatchingNet [Vinyals et al., 2016]</th><td>75.01\\pm 2.09</td><td>87.41\\pm 1.79</td><td>36.98\\pm 0.06</td><td>50.72\\pm 0.36</td></tr><tr><th>ProtoNet [Snell et al., 2017]</th><td>72.04\\pm 0.82</td><td>87.22\\pm 1.01</td><td>33.27\\pm 1.09</td><td>52.16\\pm 0.17</td></tr><tr><th>MAML [Finn et al., 2017]</th><td>72.68\\pm 1.85</td><td>83.54\\pm 1.79</td><td>34.01\\pm 1.25</td><td>48.83\\pm 0.62</td></tr><tr><th>RelationNet [Sung et al., 2018]</th><td>75.62\\pm 1.00</td><td>87.84\\pm 0.27</td><td>37.13\\pm 0.20</td><td>51.76\\pm 1.48</td></tr><tr><th>GPDKT{}^{\\textrm{Linear}} [Patacchiola et al., 2020]</th><td>75.97\\pm 0.70</td><td>89.51\\pm 0.44</td><td>38.72\\pm 0.42</td><td>54.20\\pm 0.37</td></tr><tr><th>GPDKT{}^{\\textrm{CosSim}} [Patacchiola et al., 2020]</th><td>73.06\\pm 2.36</td><td>88.10\\pm 0.78</td><td>40.22\\pm 0.54</td><td>55.65\\pm 0.05</td></tr><tr><th>GPDKT{}^{\\textrm{BNCosSim}} [Patacchiola et al., 2020]</th><td>75.40\\pm 1.10</td><td>{\\bf 90.30\\pm 0.49}</td><td>40.14\\pm 0.18</td><td>56.40\\pm 1.34</td></tr><tr><th>GPLDLA (Ours)</th><td>{\\bf 76.65\\pm 0.29}</td><td>89.71\\pm 0.14</td><td>{\\bf 41.92\\pm 0.27}</td><td>{\\bf 60.88\\pm 0.30}</td></tr></tbody></table>", "caption": "Table 4: Cross-domain classification performance. ", "list_citation_info": ["Sung et al. [2018] Flood Sung, Yongxin Yang, Li Zhang, Tao Xiang, Philip H. S. Torr, and Timothy M. Hospedales. Learning to Compare: Relation Network for Few-Shot Learning. In IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), June 2018.", "Finn et al. [2017] Chelsea Finn, Pieter Abbeel, and Sergey Levine. Model-agnostic meta-learning for fast adaptation of deep networks. In International Conference on Machine Learning, 2017.", "Snell et al. [2017] Jake Snell, Kevin Swersky, and Richard S. Zemel. Prototypical networks for few-shot learning. CoRR, abs/1703.05175, 2017. URL http://arxiv.org/abs/1703.05175.", "Chen et al. [2019] Wei-Yu Chen, Yen-Cheng Liu, Zsolt Kira, Yu-Chiang Wang, and Jia-Bin Huang. A closer look at few-shot classification. In International Conference on Learning Representations, 2019.", "Vinyals et al. [2016] Oriol Vinyals, Charles Blundell, Timothy Lillicrap, Koray Kavukcuoglu, and Daan Wierstra. Matching networks for one shot learning. In Advances in Neural Information Processing Systems, 2016.", "Patacchiola et al. [2020] Massimiliano Patacchiola, Jack Turner, Elliot J. Crowley, and Amos Storkey. Bayesian meta-learning for the few-shot setting via deep kernels. In Advances in Neural Information Processing Systems, 2020."]}, {"table": "<table><thead><tr><th>Methods</th><th>1-shot</th><th>5-shot</th></tr></thead><tbody><tr><th>Assoc-Align</th><td>47.25\\pm 0.76</td><td>{\\bf 72.37\\pm 0.89}</td></tr><tr><th>Neg-Margin</th><td>-</td><td>69.30\\pm 0.73</td></tr><tr><th>Cross-Domain</th><td>47.47\\pm 0.75</td><td>66.98\\pm 0.68</td></tr><tr><th>GPLDLA (Ours)</th><td>{\\bf 48.94\\pm 0.45}</td><td>69.83\\pm 0.36</td></tr></tbody></table>", "caption": "Table 5: Cross-domain classification performance with ResNet-18 backbone on miniImageNet\\toCUB. Assoc-Align = [Afrasiyabi et al., 2020],Neg-Margin = [Liu et al., 2020], andCross-Domain = [Tseng et al., 2020].", "list_citation_info": ["Liu et al. [2020] Bin Liu, Yue Cao, Yutong Lin, Qi Li, Zheng Zhang, Mingsheng Long, and Han Hu. Negative margin matters: Understanding margin in few-shot classification. In European Conference on Computer Vision, 2020.", "Tseng et al. [2020] Hung-Yu Tseng, Hsin-Ying Lee, Jia-Bin Huang, and Ming-Hsuan Yang. Cross-domain few-shot classification via learned feature-wise transformation. In International Conference on Learning Representations, 2020.", "Afrasiyabi et al. [2020] Arman Afrasiyabi, Jean-Fran\u00e7ois Lalonde, and Christian Gagn\u00e9. Associative alignment for few-shot image classification. In European Conference on Computer Vision, 2020."]}, {"table": "<table><thead><tr><th>Methods</th><th>1-shot</th><th>5-shot</th></tr></thead><tbody><tr><th>GPDKT [Patacchiola et al., 2020]</th><td>10.42\\pm 0.24</td><td>12.02\\pm 0.08</td></tr><tr><th>MetaQDA (Full Bayesian) [Zhang et al., 2021]</th><td>22.57\\pm 0.57</td><td>25.84\\pm 1.19</td></tr><tr><th>MetaQDA (MAP) [Zhang et al., 2021]</th><td>20.29\\pm 0.22</td><td>22.49\\pm 0.67</td></tr><tr><th>Laplace approximation</th><td>11.42\\pm 1.70</td><td>14.08\\pm 0.63</td></tr><tr><th>GPLDLA (Ours)</th><td>{\\bf 6.70\\pm 0.03}</td><td>{\\bf 6.71\\pm 0.14}</td></tr></tbody></table>", "caption": "Table 8: Per-episode inference time (milliseconds) with the Conv-4 backbone on tieredImageNet. We exclude the feature computation times and only measure the inference time, that is, time for computing p(y|x,S) for (x,y)\\in Q.", "list_citation_info": ["Zhang et al. [2021] Xueting Zhang, Debin Meng, Henry Gouk, and Timothy Hospedales. Shallow Bayesian Meta Learning for Real-World Few-Shot Recognition. arXiv preprint arXiv:2101.02833, 2021.", "Patacchiola et al. [2020] Massimiliano Patacchiola, Jack Turner, Elliot J. Crowley, and Amos Storkey. Bayesian meta-learning for the few-shot setting via deep kernels. In Advances in Neural Information Processing Systems, 2020."]}]}