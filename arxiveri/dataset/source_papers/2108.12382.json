{"title": "Isnet: Integrate image-level and semantic-level context for semantic segmentation", "abstract": "Co-occurrent visual pattern makes aggregating contextual information a common paradigm to enhance the pixel representation for semantic image segmentation. The existing approaches focus on modeling the context from the perspective of the whole image, i.e., aggregating the image-level contextual information. Despite impressive, these methods weaken the significance of the pixel representations of the same category, i.e., the semantic-level contextual information. To address this, this paper proposes to augment the pixel representations by aggregating the image-level and semantic-level contextual information, respectively. First, an image-level context module is designed to capture the contextual information for each pixel in the whole image. Second, we aggregate the representations of the same category for each pixel where the category regions are learned under the supervision of the ground-truth segmentation. Third, we compute the similarities between each pixel representation and the image-level contextual information, the semantic-level contextual information, respectively. At last, a pixel representation is augmented by weighted aggregating both the image-level contextual information and the semantic-level contextual information with the similarities as the weights. Integrating the image-level and semantic-level context allows this paper to report state-of-the-art accuracy on four benchmarks, i.e., ADE20K, LIP, COCOStuff and Cityscapes.", "authors": ["Zhenchao Jin", " Bin Liu", " Qi Chu", " Nenghai Yu"], "pdf_url": "https://arxiv.org/abs/2108.12382", "list_table_and_caption": [{"table": "<table><tbody><tr><th>Method</th><td>Parameters</td><td>FLOPs</td><td>Time</td></tr><tr><th>ASPP [5] (our impl.)</th><td>42.21M</td><td>674.47G</td><td>101.44ms</td></tr><tr><th>PPM [35] (our impl.)</th><td>23.07M</td><td>309.45G</td><td>29.57ms</td></tr><tr><th>CCNet [17] (our impl.)</th><td>23.92M</td><td>397.38G</td><td>56.90ms</td></tr><tr><th>OCRNet [30] (our impl.)</th><td>14.82M</td><td>237.45G</td><td>20.22ms</td></tr><tr><th>DANet [11] (our impl.)</th><td>23.92M</td><td>392.02G</td><td>62.64ms</td></tr><tr><th>ANN [38] (our impl.)</th><td>20.32M</td><td>335.24G</td><td>49.66ms</td></tr><tr><th>DNL [28] (our impl.)</th><td>24.12M</td><td>395.25G</td><td>68.62ms</td></tr><tr><th>APCNet [15] (our impl.)</th><td>30.46M</td><td>413.12G</td><td>54.20ms</td></tr><tr><th>ILCM (ours)</th><td>10.36M</td><td>169.77G</td><td>42.56ms</td></tr><tr><th>SLCM (ours)</th><td>10.10M</td><td>165.47G</td><td>53.12ms</td></tr><tr><th>ILCM+SLCM (ours)</th><td>11.02M</td><td>180.60G</td><td>84.19ms</td></tr></tbody></table>", "caption": "Table 2: Complexity comparison with existing context schemes.The feature map of size [1\\times 2048\\times 128\\times 128] is adopted to evaluate their complexity during inference.All the numbers are obtained on a single NVIDIA Tesla V100 GPU with CUDA 11.0 and the smaller, the better.As seen, our method requires the least Parameters and the least FLOPs.", "list_citation_info": ["[17] Zilong Huang, Xinggang Wang, Lichao Huang, Chang Huang, Yunchao Wei, and Wenyu Liu. Ccnet: Criss-cross attention for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 603\u2013612, 2019.", "[28] Minghao Yin, Zhuliang Yao, Yue Cao, Xiu Li, Zheng Zhang, Stephen Lin, and Han Hu. Disentangled non-local neural networks. In European Conference on Computer Vision, pages 191\u2013207. Springer, 2020.", "[15] Junjun He, Zhongying Deng, Lei Zhou, Yali Wang, and Yu Qiao. Adaptive pyramid context network for semantic segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 7519\u20137528, 2019.", "[38] Zhen Zhu, Mengde Xu, Song Bai, Tengteng Huang, and Xiang Bai. Asymmetric non-local neural networks for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 593\u2013602, 2019.", "[5] Liang-Chieh Chen, George Papandreou, Florian Schroff, and Hartwig Adam. Rethinking atrous convolution for semantic image segmentation. arXiv preprint arXiv:1706.05587, 2017.", "[30] Yuhui Yuan, Xilin Chen, and Jingdong Wang. Object-contextual representations for semantic segmentation. arXiv preprint arXiv:1909.11065, 2019.", "[35] Hengshuang Zhao, Jianping Shi, Xiaojuan Qi, Xiaogang Wang, and Jiaya Jia. Pyramid scene parsing network. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 2881\u20132890, 2017.", "[11] Jun Fu, Jing Liu, Haijie Tian, Yong Li, Yongjun Bao, Zhiwei Fang, and Hanqing Lu. Dual attention network for scene segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 3146\u20133154, 2019."]}, {"table": "<table><thead><tr><th>Method</th><th>Backbone</th><th>Stride</th><th>Iterations</th><th>mIoU</th></tr></thead><tbody><tr><td>PPM [35] (our impl.)</td><td>ResNet-50</td><td>8\\times</td><td>160K</td><td>42.64</td></tr><tr><td>ASPP [5] (our impl.)</td><td>ResNet-50</td><td>8\\times</td><td>160K</td><td>43.19</td></tr><tr><td>OCR [30] (our impl.)</td><td>ResNet-50</td><td>8\\times</td><td>160K</td><td>42.47</td></tr><tr><td>ANN [38] (our impl.)</td><td>ResNet-50</td><td>8\\times</td><td>160K</td><td>41.75</td></tr><tr><td>NonLocal [26] (our impl.)</td><td>ResNet-50</td><td>8\\times</td><td>160K</td><td>42.15</td></tr><tr><td>DNL [28] (our impl.)</td><td>ResNet-50</td><td>8\\times</td><td>160K</td><td>43.50</td></tr><tr><td>CCNet [17] (our impl.)</td><td>ResNet-50</td><td>8\\times</td><td>160K</td><td>42.47</td></tr><tr><td>ISNet (ours)</td><td>ResNet-50</td><td>8\\times</td><td>160K</td><td>44.09</td></tr></tbody></table>", "caption": "Table 3: Comparison with the existing context schemes in terms of mIoU.All the models here are learned on the train set of ADE20K and tested on the validation set of ADE20K.", "list_citation_info": ["[17] Zilong Huang, Xinggang Wang, Lichao Huang, Chang Huang, Yunchao Wei, and Wenyu Liu. Ccnet: Criss-cross attention for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 603\u2013612, 2019.", "[28] Minghao Yin, Zhuliang Yao, Yue Cao, Xiu Li, Zheng Zhang, Stephen Lin, and Han Hu. Disentangled non-local neural networks. In European Conference on Computer Vision, pages 191\u2013207. Springer, 2020.", "[38] Zhen Zhu, Mengde Xu, Song Bai, Tengteng Huang, and Xiang Bai. Asymmetric non-local neural networks for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 593\u2013602, 2019.", "[5] Liang-Chieh Chen, George Papandreou, Florian Schroff, and Hartwig Adam. Rethinking atrous convolution for semantic image segmentation. arXiv preprint arXiv:1706.05587, 2017.", "[26] Xiaolong Wang, Ross Girshick, Abhinav Gupta, and Kaiming He. Non-local neural networks. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 7794\u20137803, 2018.", "[30] Yuhui Yuan, Xilin Chen, and Jingdong Wang. Object-contextual representations for semantic segmentation. arXiv preprint arXiv:1909.11065, 2019.", "[35] Hengshuang Zhao, Jianping Shi, Xiaojuan Qi, Xiaogang Wang, and Jiaya Jia. Pyramid scene parsing network. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 2881\u20132890, 2017."]}, {"table": "<table><tbody><tr><td>Method</td><td>Backbone</td><td>Stride</td><td>mIoU</td></tr><tr><td>PSPNet [35]</td><td>ResNet-101</td><td>8\\times</td><td>43.29</td></tr><tr><td>PSANet [36]</td><td>ResNet-101</td><td>8\\times</td><td>43.77</td></tr><tr><td>EncNet [33]</td><td>ResNet-101</td><td>8\\times</td><td>44.65</td></tr><tr><td>OCNet [31]</td><td>ResNet-101</td><td>8\\times</td><td>45.08</td></tr><tr><td>OCRNet [30]</td><td>ResNet-101</td><td>8\\times</td><td>45.28</td></tr><tr><td>CCNet [17]</td><td>ResNet-101</td><td>8\\times</td><td>45.76</td></tr><tr><td>ANNet [38]</td><td>ResNet-101</td><td>8\\times</td><td>45.24</td></tr><tr><td>ACNet [12]</td><td>ResNet-101</td><td>8\\times</td><td>45.90</td></tr><tr><td>DMNet [14]</td><td>ResNet-101</td><td>8\\times</td><td>45.50</td></tr><tr><td>APCNet [15]</td><td>ResNet-101</td><td>8\\times</td><td>45.38</td></tr><tr><td>DANet [11]</td><td>ResNet-101</td><td>8\\times</td><td>45.22</td></tr><tr><td>OCRNet [30]</td><td>HRNetV2-W48</td><td>4\\times</td><td>45.66</td></tr><tr><td>ISNet (ours)</td><td>ResNet-50</td><td>8\\times</td><td>45.04</td></tr><tr><td>ISNet (ours)</td><td>ResNet-101</td><td>8\\times</td><td>47.31</td></tr><tr><td>ISNet (ours)</td><td>ResNeSt-101</td><td>8\\times</td><td>47.55</td></tr></tbody></table>", "caption": "Table 4: Segmentation results on ADE20K validation set.Multi-scale and flipping testing is employed here for fair comparison.The best score is marked in bold.", "list_citation_info": ["[17] Zilong Huang, Xinggang Wang, Lichao Huang, Chang Huang, Yunchao Wei, and Wenyu Liu. Ccnet: Criss-cross attention for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 603\u2013612, 2019.", "[12] Jun Fu, Jing Liu, Yuhang Wang, Yong Li, Yongjun Bao, Jinhui Tang, and Hanqing Lu. Adaptive context network for scene parsing. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 6748\u20136757, 2019.", "[33] Hang Zhang, Kristin Dana, Jianping Shi, Zhongyue Zhang, Xiaogang Wang, Ambrish Tyagi, and Amit Agrawal. Context encoding for semantic segmentation. In Proceedings of the IEEE conference on Computer Vision and Pattern Recognition, pages 7151\u20137160, 2018.", "[15] Junjun He, Zhongying Deng, Lei Zhou, Yali Wang, and Yu Qiao. Adaptive pyramid context network for semantic segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 7519\u20137528, 2019.", "[31] Yuhui Yuan and Jingdong Wang. Ocnet: Object context network for scene parsing. arXiv preprint arXiv:1809.00916, 2018.", "[38] Zhen Zhu, Mengde Xu, Song Bai, Tengteng Huang, and Xiang Bai. Asymmetric non-local neural networks for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 593\u2013602, 2019.", "[14] Junjun He, Zhongying Deng, and Yu Qiao. Dynamic multi-scale filters for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 3562\u20133572, 2019.", "[30] Yuhui Yuan, Xilin Chen, and Jingdong Wang. Object-contextual representations for semantic segmentation. arXiv preprint arXiv:1909.11065, 2019.", "[35] Hengshuang Zhao, Jianping Shi, Xiaojuan Qi, Xiaogang Wang, and Jiaya Jia. Pyramid scene parsing network. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 2881\u20132890, 2017.", "[36] Hengshuang Zhao, Yi Zhang, Shu Liu, Jianping Shi, Chen Change Loy, Dahua Lin, and Jiaya Jia. Psanet: Point-wise spatial attention network for scene parsing. In Proceedings of the European Conference on Computer Vision (ECCV), pages 267\u2013283, 2018.", "[11] Jun Fu, Jing Liu, Haijie Tian, Yong Li, Yongjun Bao, Zhiwei Fang, and Hanqing Lu. Dual attention network for scene segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 3146\u20133154, 2019."]}, {"table": "<table><tbody><tr><td>Method</td><td>Backbone</td><td>Stride</td><td>mIoU</td></tr><tr><td>OCRNet [30]</td><td>ResNet-101</td><td>8\\times</td><td>39.50</td></tr><tr><td>SVCNet [10]</td><td>ResNet-101</td><td>8\\times</td><td>39.60</td></tr><tr><td>DANet [11]</td><td>ResNet-101</td><td>8\\times</td><td>39.70</td></tr><tr><td>EMANet [20]</td><td>ResNet-101</td><td>8\\times</td><td>39.90</td></tr><tr><td>SpyGR [19]</td><td>ResNet-101</td><td>8\\times</td><td>39.90</td></tr><tr><td>ACNet [12]</td><td>ResNet-101</td><td>8\\times</td><td>40.10</td></tr><tr><td>OCRNet [30]</td><td>HRNetV2-W48</td><td>4\\times</td><td>40.50</td></tr><tr><td>ISNet (ours)</td><td>ResNet-50</td><td>8\\times</td><td>40.16</td></tr><tr><td>ISNet (ours)</td><td>ResNet-101</td><td>8\\times</td><td>41.60</td></tr><tr><td>ISNet (ours)</td><td>ResNeSt-101</td><td>8\\times</td><td>42.08</td></tr></tbody></table>", "caption": "Table 5: Comparison of performance on the test set of COCOStuff with state-of-the-art approaches.Multi-scale and flipping testing is leveraged here for fair comparison.", "list_citation_info": ["[10] Henghui Ding, Xudong Jiang, Bing Shuai, Ai Qun Liu, and Gang Wang. Semantic correlation promoted shape-variant context for segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 8885\u20138894, 2019.", "[20] Xia Li, Zhisheng Zhong, Jianlong Wu, Yibo Yang, Zhouchen Lin, and Hong Liu. Expectation-maximization attention networks for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 9167\u20139176, 2019.", "[12] Jun Fu, Jing Liu, Yuhang Wang, Yong Li, Yongjun Bao, Jinhui Tang, and Hanqing Lu. Adaptive context network for scene parsing. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 6748\u20136757, 2019.", "[30] Yuhui Yuan, Xilin Chen, and Jingdong Wang. Object-contextual representations for semantic segmentation. arXiv preprint arXiv:1909.11065, 2019.", "[19] Xia Li, Yibo Yang, Qijie Zhao, Tiancheng Shen, Zhouchen Lin, and Hong Liu. Spatial pyramid based graph reasoning for semantic segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 8950\u20138959, 2020.", "[11] Jun Fu, Jing Liu, Haijie Tian, Yong Li, Yongjun Bao, Zhiwei Fang, and Hanqing Lu. Dual attention network for scene segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 3146\u20133154, 2019."]}, {"table": "<table><tbody><tr><td>Method</td><td>Backbone</td><td>Stride</td><td>mIoU</td></tr><tr><td>DeepLab [4]</td><td>ResNet-101</td><td>-</td><td>44.80</td></tr><tr><td>CE2P [23]</td><td>ResNet-101</td><td>16\\times</td><td>53.10</td></tr><tr><td>OCRNet [30]</td><td>ResNet-101</td><td>8\\times</td><td>55.60</td></tr><tr><td>OCNet [31]</td><td>ResNet-101</td><td>8\\times</td><td>54.72</td></tr><tr><td>CCNet [17]</td><td>ResNet-101</td><td>8\\times</td><td>55.47</td></tr><tr><td>HRNet [25]</td><td>HRNetV2-W48</td><td>4\\times</td><td>55.90</td></tr><tr><td>OCRNet [30]</td><td>HRNetV2-W48</td><td>4\\times</td><td>56.65</td></tr><tr><td>ISNet (ours)</td><td>ResNet-50</td><td>8\\times</td><td>53.41</td></tr><tr><td>ISNet (ours)</td><td>ResNet-101</td><td>8\\times</td><td>55.41</td></tr><tr><td>ISNet (ours)</td><td>ResNeSt-101</td><td>8\\times</td><td>56.81</td></tr><tr><td>ASPP (our impl.)</td><td>ResNet-101</td><td>8\\times</td><td>55.34</td></tr><tr><td>ISNet\\ddagger (ours)</td><td>ResNet-101</td><td>8\\times</td><td>56.96</td></tr></tbody></table>", "caption": "Table 6: State-of-the-art comparison on the validation set of LIP.Flipping testing is utilized here for fair comparison.\\ddagger means that we adopt ASPP as the image-level context module.", "list_citation_info": ["[17] Zilong Huang, Xinggang Wang, Lichao Huang, Chang Huang, Yunchao Wei, and Wenyu Liu. Ccnet: Criss-cross attention for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 603\u2013612, 2019.", "[31] Yuhui Yuan and Jingdong Wang. Ocnet: Object context network for scene parsing. arXiv preprint arXiv:1809.00916, 2018.", "[25] Jingdong Wang, Ke Sun, Tianheng Cheng, Borui Jiang, Chaorui Deng, Yang Zhao, Dong Liu, Yadong Mu, Mingkui Tan, Xinggang Wang, et al. Deep high-resolution representation learning for visual recognition. IEEE transactions on pattern analysis and machine intelligence, 2020.", "[30] Yuhui Yuan, Xilin Chen, and Jingdong Wang. Object-contextual representations for semantic segmentation. arXiv preprint arXiv:1909.11065, 2019.", "[23] Tao Ruan, Ting Liu, Zilong Huang, Yunchao Wei, Shikui Wei, and Yao Zhao. Devil in the details: Towards accurate single and multiple human parsing. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 33, pages 4814\u20134821, 2019.", "[4] Liang-Chieh Chen, George Papandreou, Iasonas Kokkinos, Kevin Murphy, and Alan L Yuille. Deeplab: Semantic image segmentation with deep convolutional nets, atrous convolution, and fully connected crfs. IEEE transactions on pattern analysis and machine intelligence, 40(4):834\u2013848, 2017."]}, {"table": "<table><tbody><tr><td>Method</td><td>Backbone</td><td>Stride</td><td>mIoU</td></tr><tr><td>GCNet [3, 8]</td><td>ResNet-101</td><td>8\\times</td><td>79.03</td></tr><tr><td>PSPNet [35, 8]</td><td>ResNet-101</td><td>8\\times</td><td>79.76</td></tr><tr><td>PSANet [36, 8]</td><td>ResNet-101</td><td>8\\times</td><td>79.31</td></tr><tr><td>ANN [38, 8]</td><td>ResNet-101</td><td>8\\times</td><td>77.14</td></tr><tr><td>NonLocal [26, 8]</td><td>ResNet-101</td><td>8\\times</td><td>78.93</td></tr><tr><td>CCNet [17, 8]</td><td>ResNet-101</td><td>8\\times</td><td>78.87</td></tr><tr><td>EncNet [33, 8]</td><td>ResNet-101</td><td>8\\times</td><td>78.55</td></tr><tr><td>DANet [11, 8]</td><td>ResNet-101</td><td>8\\times</td><td>80.41</td></tr><tr><td>DNL [28, 8]</td><td>ResNet-101</td><td>8\\times</td><td>80.41</td></tr><tr><td>OCRNet [30, 8]</td><td>HRNetV2-W48</td><td>4\\times</td><td>80.70</td></tr><tr><td>ISNet (ours)</td><td>ResNet-50</td><td>8\\times</td><td>79.32</td></tr><tr><td>ISNet (ours)</td><td>ResNet-101</td><td>8\\times</td><td>80.56</td></tr><tr><td>ISNet\\ddagger (ours)</td><td>ResNet-101</td><td>8\\times</td><td>81.10</td></tr></tbody></table>", "caption": "Table 7: Segmentation results on Cityscapes validation set.Only single-scale testing is adopted here.", "list_citation_info": ["[17] Zilong Huang, Xinggang Wang, Lichao Huang, Chang Huang, Yunchao Wei, and Wenyu Liu. Ccnet: Criss-cross attention for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 603\u2013612, 2019.", "[33] Hang Zhang, Kristin Dana, Jianping Shi, Zhongyue Zhang, Xiaogang Wang, Ambrish Tyagi, and Amit Agrawal. Context encoding for semantic segmentation. In Proceedings of the IEEE conference on Computer Vision and Pattern Recognition, pages 7151\u20137160, 2018.", "[28] Minghao Yin, Zhuliang Yao, Yue Cao, Xiu Li, Zheng Zhang, Stephen Lin, and Han Hu. Disentangled non-local neural networks. In European Conference on Computer Vision, pages 191\u2013207. Springer, 2020.", "[38] Zhen Zhu, Mengde Xu, Song Bai, Tengteng Huang, and Xiang Bai. Asymmetric non-local neural networks for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 593\u2013602, 2019.", "[3] Yue Cao, Jiarui Xu, Stephen Lin, Fangyun Wei, and Han Hu. Gcnet: Non-local networks meet squeeze-excitation networks and beyond. In Proceedings of the IEEE/CVF International Conference on Computer Vision Workshops, pages 0\u20130, 2019.", "[26] Xiaolong Wang, Ross Girshick, Abhinav Gupta, and Kaiming He. Non-local neural networks. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 7794\u20137803, 2018.", "[30] Yuhui Yuan, Xilin Chen, and Jingdong Wang. Object-contextual representations for semantic segmentation. arXiv preprint arXiv:1909.11065, 2019.", "[35] Hengshuang Zhao, Jianping Shi, Xiaojuan Qi, Xiaogang Wang, and Jiaya Jia. Pyramid scene parsing network. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 2881\u20132890, 2017.", "[36] Hengshuang Zhao, Yi Zhang, Shu Liu, Jianping Shi, Chen Change Loy, Dahua Lin, and Jiaya Jia. Psanet: Point-wise spatial attention network for scene parsing. In Proceedings of the European Conference on Computer Vision (ECCV), pages 267\u2013283, 2018.", "[11] Jun Fu, Jing Liu, Haijie Tian, Yong Li, Yongjun Bao, Zhiwei Fang, and Hanqing Lu. Dual attention network for scene segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 3146\u20133154, 2019."]}]}