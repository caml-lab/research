{"title": "Characterizing Renal Structures with 3D Block Aggregate Transformers", "abstract": "Efficiently quantifying renal structures can provide distinct spatial context\nand facilitate biomarker discovery for kidney morphology. However, the\ndevelopment and evaluation of the transformer model to segment the renal\ncortex, medulla, and collecting system remains challenging due to data\ninefficiency. Inspired by the hierarchical structures in vision transformer, we\npropose a novel method using a 3D block aggregation transformer for segmenting\nkidney components on contrast-enhanced CT scans. We construct the first cohort\nof renal substructures segmentation dataset with 116 subjects under\ninstitutional review board (IRB) approval. Our method yields the\nstate-of-the-art performance (Dice of 0.8467) against the baseline approach of\n0.8308 with the data-efficient design. The Pearson R achieves 0.9891 between\nthe proposed method and manual standards and indicates the strong correlation\nand reproducibility for volumetric analysis. We extend the proposed method to\nthe public KiTS dataset, the method leads to improved accuracy compared to\ntransformer-based approaches. We show that the 3D block aggregation transformer\ncan achieve local communication between sequence representations without\nmodifying self-attention, and it can serve as an accurate and efficient\nquantification tool for characterizing renal structures.", "authors": ["Xin Yu", "Yucheng Tang", "Yinchi Zhou", "Riqiang Gao", "Qi Yang", "Ho Hin Lee", "Thomas Li", "Shunxing Bao", "Yuankai Huo", "Zhoubing Xu", "Thomas A. Lasko", "Richard G. Abramson", "Bennett A. Landman"], "published_date": "2022_03_04", "pdf_url": "http://arxiv.org/pdf/2203.02430v1", "list_table_and_caption": [{"table": "<table><tbody><tr><th rowspan=\"2\">Method</th><td rowspan=\"2\">#Param</td><td rowspan=\"2\">GFLOPS</td><td colspan=\"2\">Cortex</td><td colspan=\"2\">Medulla</td><td colspan=\"2\">Pelvicalyceal System</td><td colspan=\"2\">Avg.</td></tr><tr><td>DSC</td><td>HD</td><td>DSC</td><td>HD</td><td>DSC</td><td>HD</td><td>DSC</td><td>HD</td></tr><tr><th>Chen et al. [4]</th><td>N/A</td><td>N/A</td><td>0.7512</td><td>40.1947</td><td>N/A</td><td>N/A</td><td>N/A</td><td>N/A</td><td>N/A</td><td>N/A</td></tr><tr><th>Xiang et al. [28]</th><td>N/A</td><td>N/A</td><td>0.8196</td><td>27.1455</td><td>N/A</td><td>N/A</td><td>N/A</td><td>N/A</td><td>N/A</td><td>N/A</td></tr><tr><th>Jin et al. [16]</th><td>N/A</td><td>N/A</td><td>0.8041</td><td>34.5170</td><td>0.7186</td><td>32.1059</td><td>0.6473</td><td>39.9125</td><td>0.7233</td><td>35.5118</td></tr><tr><th>Tang et al. [23]</th><td>40.9M</td><td>423.9</td><td>0.8601</td><td>19.7508</td><td>0.7884</td><td>18.6030</td><td>0.7490</td><td>34.1723</td><td>0.7991</td><td>24.1754</td></tr><tr><th>nnUNet [14]</th><td>19.1M (3DUNet)</td><td>412.7</td><td>0.8915</td><td>17.3764</td><td>0.8002</td><td>18.3132</td><td>0.7309</td><td>31.3501</td><td>0.8075</td><td>22.3466</td></tr><tr><th>TransBTS [27]</th><td>33.0M</td><td>359.4</td><td>0.8901</td><td>17.0213</td><td>0.8013</td><td>17.3084</td><td>0.7305</td><td>30.8745</td><td>0.8073</td><td>21.7347</td></tr><tr><th>CoTr [29]</th><td>46.5M</td><td>399.2</td><td>0.8958</td><td>16.4904</td><td>0.8019</td><td>16.5934</td><td>0.7393</td><td>30.1282</td><td>0.8123</td><td>21.0707</td></tr><tr><th>nnFormer [32]</th><td>158.9M</td><td>146.5</td><td>0.9094</td><td>15.5839</td><td>0.8104</td><td>15.9412</td><td>0.7418</td><td>29.4407</td><td>0.8205</td><td>20.3219</td></tr><tr><th>UNETR [11]</th><td>92.6M</td><td>41.2</td><td>0.9072</td><td>15.9829</td><td>0.8221</td><td>14.9555</td><td>0.7632</td><td>27.4703</td><td>0.8308</td><td>19.4696</td></tr><tr><th>UNesT</th><td>87.3M</td><td>37.5</td><td>0.9201</td><td>14.5401</td><td>0.8356</td><td>13.5933</td><td>0.7843</td><td>24.5445</td><td>0.8467*</td><td>17.5593</td></tr></tbody></table>", "caption": "Table 1: Segmentation results of the renal substructure on testing cases. The UNesT achieves state-of-the-art performance compared to prior kidney components studies and 3D medical segmentation baselines. The number of parameters and GFLOPS (with a single input volume of 96\\times 96\\times 96) are shown for deep learning-based approaches. * indicates statistically significant (p&lt;0.01) by Wilcoxon signed-rank test.", "list_citation_info": ["[16] Jin, C., Shi, F., Xiang, D., Jiang, X., Zhang, B., Wang, X., Zhu, W., Gao, E., Chen, X.: 3d fast automatic segmentation of kidney based on modified aam and random forest. IEEE transactions on medical imaging 35(6), 1395\u20131407 (2016)", "[32] Zhou, H.Y., Guo, J., Zhang, Y., Yu, L., Wang, L., Yu, Y.: nnformer: Interleaved transformer for volumetric segmentation. arXiv preprint arXiv:2109.03201 (2021)", "[23] Tang, Y., Gao, R., Lee, H.H., Xu, Z., Savoie, B.V., Bao, S., Huo, Y., Fogo, A.B., Harris, R., de Caestecker, M.P., et al.: Renal cortex, medulla and pelvicaliceal system segmentation on arterial phase ct images with random patch-based networks. In: Medical Imaging 2021: Image Processing. vol. 11596, p. 115961D. International Society for Optics and Photonics (2021)", "[14] Isensee, F., Jaeger, P.F., Kohl, S.A., Petersen, J., Maier-Hein, K.H.: nnu-net: a self-configuring method for deep learning-based biomedical image segmentation. Nature Methods 18(2), 203\u2013211 (2021)", "[11] Hatamizadeh, A., Tang, Y., Nath, V., Yang, D., Myronenko, A., Landman, B., Roth, H., Xu, D.: Unetr: Transformers for 3d medical image segmentation. arXiv preprint arXiv:2103.10504 (2021)", "[28] Xiang, D., Bagci, U., Jin, C., Shi, F., Zhu, W., Yao, J., Sonka, M., Chen, X.: Cortexpert: A model-based method for automatic renal cortex segmentation. Medical image analysis 42, 257\u2013273 (2017)", "[27] Wang, W., Chen, C., Ding, M., Li, J., Yu, H., Zha, S.: Transbts: Multimodal brain tumor segmentation using transformer. arXiv preprint arXiv:2103.04430 (2021)", "[4] Chen, X., Summers, R.M., Cho, M., Bagci, U., Yao, J.: An automatic method for renal cortex segmentation on ct images: evaluation on kidney donors. Academic radiology (2012)", "[29] Xie, Y., Zhang, J., Shen, C., Xia, Y.: Cotr: Efficiently bridging cnn and transformer for 3d medical image segmentation. International conference on medical image computing and computer-assisted intervention (2021)"]}, {"table": "<table><thead><tr><th rowspan=\"2\">Metrics</th><th colspan=\"2\">Cortex</th><th colspan=\"2\">Medulla</th><th colspan=\"2\">Pelvicalyceal System</th></tr><tr><th>Tang et al. [23]</th><th>UNesT</th><th>Tang et al. [23]</th><th>UNesT</th><th>Tang et al. [23]</th><th>UNesT</th></tr></thead><tbody><tr><th>R Squared</th><td>0.9200</td><td>0.9359</td><td>0.6652</td><td>0.6837</td><td>0.4586</td><td>0.5917</td></tr><tr><th>Pearson R</th><td>0.9838</td><td>0.9891</td><td>0.8156</td><td>0.8368</td><td>0.6772</td><td>0.7148</td></tr><tr><th>Absolute Deviation of Volume</th><td>3.0233</td><td>2.7254</td><td>3.5496</td><td>3.2958</td><td>0.9443</td><td>0.8012</td></tr><tr><th>Percentage Difference</th><td>4.8280</td><td>3.9478</td><td>7.4750</td><td>7.0382</td><td>19.0716</td><td>13.5737</td></tr></tbody></table>", "caption": "Table 2: Comparison of volumetric analysis metrics between the proposed method and the state-of-the-art clinical study on kidney components.", "list_citation_info": ["[23] Tang, Y., Gao, R., Lee, H.H., Xu, Z., Savoie, B.V., Bao, S., Huo, Y., Fogo, A.B., Harris, R., de Caestecker, M.P., et al.: Renal cortex, medulla and pelvicaliceal system segmentation on arterial phase ct images with random patch-based networks. In: Medical Imaging 2021: Image Processing. vol. 11596, p. 115961D. International Society for Optics and Photonics (2021)"]}], "citation_info_to_title": {"[23] Tang, Y., Gao, R., Lee, H.H., Xu, Z., Savoie, B.V., Bao, S., Huo, Y., Fogo, A.B., Harris, R., de Caestecker, M.P., et al.: Renal cortex, medulla and pelvicaliceal system segmentation on arterial phase ct images with random patch-based networks. In: Medical Imaging 2021: Image Processing. vol. 11596, p. 115961D. International Society for Optics and Photonics (2021)": "Renal Cortex, Medulla and Pelvicaliceal System Segmentation on Arterial Phase CT Images with Random Patch-Based Networks", "[29] Xie, Y., Zhang, J., Shen, C., Xia, Y.: Cotr: Efficiently bridging cnn and transformer for 3d medical image segmentation. International conference on medical image computing and computer-assisted intervention (2021)": "Cotr: Efficiently Bridging CNN and Transformer for 3D Medical Image Segmentation", "[16] Jin, C., Shi, F., Xiang, D., Jiang, X., Zhang, B., Wang, X., Zhu, W., Gao, E., Chen, X.: 3d fast automatic segmentation of kidney based on modified aam and random forest. IEEE transactions on medical imaging 35(6), 1395\u20131407 (2016)": "3D Fast Automatic Segmentation of Kidney Based on Modified AAM and Random Forest", "[32] Zhou, H.Y., Guo, J., Zhang, Y., Yu, L., Wang, L., Yu, Y.: nnformer: Interleaved transformer for volumetric segmentation. arXiv preprint arXiv:2109.03201 (2021)": "nnformer: Interleaved transformer for volumetric segmentation", "[14] Isensee, F., Jaeger, P.F., Kohl, S.A., Petersen, J., Maier-Hein, K.H.: nnu-net: a self-configuring method for deep learning-based biomedical image segmentation. Nature Methods 18(2), 203\u2013211 (2021)": "Isensee et al - nnu-net: a self-configuring method for deep learning-based biomedical image segmentation", "[27] Wang, W., Chen, C., Ding, M., Li, J., Yu, H., Zha, S.: Transbts: Multimodal brain tumor segmentation using transformer. arXiv preprint arXiv:2103.04430 (2021)": "Transbts: Multimodal Brain Tumor Segmentation Using Transformer", "[4] Chen, X., Summers, R.M., Cho, M., Bagci, U., Yao, J.: An automatic method for renal cortex segmentation on ct images: evaluation on kidney donors. Academic radiology (2012)": "An automatic method for renal cortex segmentation on CT images: Evaluation on kidney donors", "[28] Xiang, D., Bagci, U., Jin, C., Shi, F., Zhu, W., Yao, J., Sonka, M., Chen, X.: Cortexpert: A model-based method for automatic renal cortex segmentation. Medical image analysis 42, 257\u2013273 (2017)": "Cortexpert: A model-based method for automatic renal cortex segmentation", "[11] Hatamizadeh, A., Tang, Y., Nath, V., Yang, D., Myronenko, A., Landman, B., Roth, H., Xu, D.: Unetr: Transformers for 3d medical image segmentation. arXiv preprint arXiv:2103.10504 (2021)": "Unetr: Transformers for 3d Medical Image Segmentation"}, "source_title_to_arxiv_id": {"nnformer: Interleaved transformer for volumetric segmentation": "2109.03201"}}