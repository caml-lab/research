{"title": "ConfMix: Unsupervised Domain Adaptation for Object Detection via Confidence-based Mixing", "abstract": "Unsupervised Domain Adaptation (UDA) for object detection aims to adapt a\nmodel trained on a source domain to detect instances from a new target domain\nfor which annotations are not available. Different from traditional approaches,\nwe propose ConfMix, the first method that introduces a sample mixing strategy\nbased on region-level detection confidence for adaptive object detector\nlearning. We mix the local region of the target sample that corresponds to the\nmost confident pseudo detections with a source image, and apply an additional\nconsistency loss term to gradually adapt towards the target data distribution.\nIn order to robustly define a confidence score for a region, we exploit the\nconfidence score per pseudo detection that accounts for both the\ndetector-dependent confidence and the bounding box uncertainty. Moreover, we\npropose a novel pseudo labelling scheme that progressively filters the pseudo\ntarget detections using the confidence metric that varies from a loose to\nstrict manner along the training. We perform extensive experiments with three\ndatasets, achieving state-of-the-art performance in two of them and approaching\nthe supervised target model performance in the other. Code is available at:\nhttps://github.com/giuliomattolin/ConfMix.", "authors": ["Giulio Mattolin", "Luca Zanella", "Elisa Ricci", "Yiming Wang"], "published_date": "2022_10_20", "pdf_url": "http://arxiv.org/pdf/2210.11539v1", "list_table_and_caption": [{"table": "<table><tbody><tr><td></td><td></td><td></td><td>Sim10K\\rightarrow</td><td>KITTI\\rightarrow</td></tr><tr><td></td><td></td><td></td><td>Cityscapes</td><td>Cityscapes</td></tr><tr><td>Method</td><td>Detector</td><td>Backbone</td><td>mAP</td><td>mAP</td></tr><tr><td>Source only</td><td>YOLOv5</td><td>CSP-Darknet53</td><td>49.5</td><td>39.9</td></tr><tr><td>SC-UDA [49]</td><td>Faster R-CNN</td><td>VGG-16</td><td>52.4</td><td>46.4</td></tr><tr><td>MeGA-CDA [43]</td><td>Faster R-CNN</td><td>VGG-16</td><td>44.8</td><td>43.0</td></tr><tr><td>FL-UDA [27]</td><td>Faster R-CNN</td><td>VGG-16</td><td>43.1</td><td>44.6</td></tr><tr><td>CDN [39]</td><td>Faster R-CNN</td><td>VGG-16</td><td>49.3</td><td>44.9</td></tr><tr><td>SAPN [22]</td><td>Faster R-CNN</td><td>VGG-16</td><td>44.9</td><td>43.4</td></tr><tr><td>CTRP [52]</td><td>Faster R-CNN</td><td>VGG-16</td><td>44.5</td><td>43.6</td></tr><tr><td>IRGG [44]</td><td>Faster R-CNN</td><td>ResNet-50</td><td>43.2</td><td>45.7</td></tr><tr><td>SSOD [36]</td><td>Faster R-CNN</td><td>ResNet-50</td><td>49.3</td><td>47.6</td></tr><tr><td>GIPA [46]</td><td>Faster R-CNN</td><td>ResNet-50</td><td>47.6</td><td>47.9</td></tr><tr><td>MGA [53]</td><td>FCOS</td><td>VGG-16</td><td>54.6</td><td>48.5</td></tr><tr><td>SIGMA [26]</td><td>FCOS</td><td>VGG-16</td><td>53.7</td><td>45.8</td></tr><tr><td>SCAN [25]</td><td>FCOS</td><td>VGG-16</td><td>52.6</td><td>45.8</td></tr><tr><td>EPM [18]</td><td>FCOS</td><td>ResNet-101</td><td>51.2</td><td>45.0</td></tr><tr><td>ConfMix (Ours)</td><td>YOLOv5</td><td>CSP-Darknet53</td><td>56.3</td><td>52.2</td></tr><tr><td>Oracle</td><td>YOLOv5</td><td>CSP-Darknet53</td><td>70.3</td><td>70.3</td></tr></tbody></table>", "caption": "Table 1: Quantitative results (mAP) for Sim10K/KITTI \\rightarrow Cityscapes benchmark.", "list_citation_info": ["[46] Minghao Xu, Hang Wang, Bingbing Ni, Qi Tian, and Wenjun Zhang. Cross-domain detection via graph-induced prototype alignment. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 12355\u201312364, 2020.", "[18] Cheng-Chun Hsu, Yi-Hsuan Tsai, Yen-Yu Lin, and Ming-Hsuan Yang. Every pixel matters: Center-aware feature alignment for domain adaptive object detector. In Proceedings of European Conference on Computer Vision, pages 733\u2013748. Springer, 2020.", "[43] Vibashan Vs, Vikram Gupta, Poojan Oza, Vishwanath A Sindagi, and Vishal M Patel. Mega-cda: Memory guided attention for category-aware unsupervised domain adaptive object detection. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 4516\u20134526, 2021.", "[53] Wenzhang Zhou, Dawei Du, Libo Zhang, Tiejian Luo, and Yanjun Wu. Multi-granularity alignment domain adaptation for object detection. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 9581\u20139590, 2022.", "[36] Farzaneh Rezaeianaran, Rakshith Shetty, Rahaf Aljundi, Daniel Olmeda Reino, Shanshan Zhang, and Bernt Schiele. Seeking similarities over differences: Similarity-based domain alignment for adaptive object detection. In Proceedings of IEEE/CVF International Conference on Computer Vision, pages 9204\u20139213, 2021.", "[25] Wuyang Li, Xinyu Liu, Xiwen Yao, and Yixuan Yuan. Scan: Cross domain object detection with semantic conditioned adaptation. In AAAI, volume 6, page 7, 2022.", "[52] Ganlong Zhao, Guanbin Li, Ruijia Xu, and Liang Lin. Collaborative training between region proposal localization and classification for domain adaptive object detection. In Proceedings of European Conference on Computer Vision, pages 86\u2013102. Springer, 2020.", "[44] Vibashan VS, Poojan Oza, and Vishal M Patel. Instance relation graph guided source-free domain adaptive object detection. arXiv preprint arXiv:2203.15793, 2022.", "[26] Wuyang Li, Xinyu Liu, and Yixuan Yuan. Sigma: Semantic-complete graph matching for domain adaptive object detection. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 5291\u20135300, 2022.", "[22] Congcong Li, Dawei Du, Libo Zhang, Longyin Wen, Tiejian Luo, Yanjun Wu, and Pengfei Zhu. Spatial attention pyramid network for unsupervised domain adaptation. In Proceedings of European Conference on Computer Vision, pages 481\u2013497. Springer, 2020.", "[39] Peng Su, Kun Wang, Xingyu Zeng, Shixiang Tang, Dapeng Chen, Di Qiu, and Xiaogang Wang. Adapting object detectors with conditional domain normalization. In Proceedings of European Conference on Computer Vision, pages 403\u2013419. Springer, 2020.", "[27] Xianfeng Li, Weijie Chen, Di Xie, Shicai Yang, Peng Yuan, Shiliang Pu, and Yueting Zhuang. A free lunch for unsupervised domain adaptive object detection without source data. In Proceedings of Conference on Artificial Intelligence, volume 35, pages 8474\u20138481, 2021.", "[49] Fuxun Yu, Di Wang, Yinpeng Chen, Nikolaos Karianakis, Tong Shen, Pei Yu, Dimitrios Lymberopoulos, Sidi Lu, Weisong Shi, and Xiang Chen. Sc-uda: Style and content gaps aware unsupervised domain adaptation for object detection. In Proceedings of IEEE/CVF Winter Conference on Applications of Computer Vision (WACV), pages 1061\u20131070, 2022."]}, {"table": "<table><tbody><tr><td>Method</td><td>Detector</td><td>Backbone</td><td>person</td><td>rider</td><td>car</td><td>truck</td><td>bus</td><td>train</td><td>motorcycle</td><td>bicycle</td><td>mAP</td></tr><tr><td>Source only</td><td>YOLOv5</td><td>CSP-Darknet53</td><td>34.8</td><td>37.6</td><td>48.7</td><td>14.3</td><td>30.1</td><td>8.8</td><td>14.6</td><td>28.1</td><td>27.1</td></tr><tr><td>SC-UDA [49]</td><td>Faster R-CNN</td><td>VGG-16</td><td>38.5</td><td>43.7</td><td>56.0</td><td>27.1</td><td>43.8</td><td>29.7</td><td>31.2</td><td>39.5</td><td>38.7</td></tr><tr><td>MeGA-CDA [43]</td><td>Faster R-CNN</td><td>VGG-16</td><td>37.7</td><td>49.0</td><td>52.4</td><td>25.4</td><td>49.2</td><td>46.9</td><td>34.5</td><td>39.0</td><td>41.8</td></tr><tr><td>FL-UDA [27]</td><td>Faster R-CNN</td><td>VGG-16</td><td>30.4</td><td>51.9</td><td>44.4</td><td>34.1</td><td>25.7</td><td>30.3</td><td>37.2</td><td>41.8</td><td>37.0</td></tr><tr><td>CDN [39]</td><td>Faster R-CNN</td><td>VGG-16</td><td>35.8</td><td>45.7</td><td>50.9</td><td>30.1</td><td>42.5</td><td>29.8</td><td>30.8</td><td>36.5</td><td>36.6</td></tr><tr><td>SAPN [22]</td><td>Faster R-CNN</td><td>VGG-16</td><td>40.8</td><td>46.7</td><td>59.8</td><td>24.3</td><td>46.8</td><td>37.5</td><td>30.4</td><td>40.7</td><td>40.9</td></tr><tr><td>CTRP [52]</td><td>Faster R-CNN</td><td>VGG-16</td><td>32.7</td><td>44.4</td><td>50.1</td><td>21.7</td><td>45.6</td><td>25.4</td><td>30.1</td><td>36.8</td><td>35.9</td></tr><tr><td>MGA [53]</td><td>Faster R-CNN</td><td>VGG-16</td><td>43.9</td><td>49.6</td><td>60.6</td><td>29.6</td><td>50.7</td><td>39.0</td><td>38.3</td><td>42.8</td><td>44.3</td></tr><tr><td>IRGG [44]</td><td>Faster R-CNN</td><td>ResNet-50</td><td>37.4</td><td>45.2</td><td>51.9</td><td>24.4</td><td>39.6</td><td>25.2</td><td>31.5</td><td>41.6</td><td>37.1</td></tr><tr><td>SSOD [36]</td><td>Faster R-CNN</td><td>ResNet-50</td><td>38.8</td><td>45.9</td><td>57.2</td><td>29.9</td><td>50.2</td><td>51.9</td><td>31.9</td><td>40.9</td><td>43.3</td></tr><tr><td>GIPA [46]</td><td>Faster R-CNN</td><td>ResNet-50</td><td>32.9</td><td>46.7</td><td>54.1</td><td>24.7</td><td>45.7</td><td>41.1</td><td>32.4</td><td>38.7</td><td>39.5</td></tr><tr><td>SCAN [25]</td><td>FCOS</td><td>VGG-16</td><td>41.7</td><td>43.9</td><td>57.3</td><td>28.7</td><td>48.6</td><td>48.7</td><td>31.0</td><td>37.3</td><td>42.1</td></tr><tr><td>SIGMA [26]</td><td>FCOS</td><td>ResNet-50</td><td>44.0</td><td>43.9</td><td>60.3</td><td>31.6</td><td>50.4</td><td>51.5</td><td>31.7</td><td>40.6</td><td>44.2</td></tr><tr><td>EPM [18]</td><td>FCOS</td><td>ResNet-101</td><td>41.5</td><td>43.6</td><td>57.1</td><td>29.4</td><td>44.9</td><td>39.7</td><td>29.0</td><td>36.1</td><td>40.2</td></tr><tr><td>ConfMix (Ours)</td><td>YOLOv5</td><td>CSP-Darknet53</td><td>45.0</td><td>43.4</td><td>62.6</td><td>27.3</td><td>45.8</td><td>40.0</td><td>28.6</td><td>33.5</td><td>40.8</td></tr><tr><td>Oracle</td><td>YOLOv5</td><td>CSP-Darknet53</td><td>42.3</td><td>43.9</td><td>65.9</td><td>33.6</td><td>45.0</td><td>37.5</td><td>29.3</td><td>36.7</td><td>42.3</td></tr></tbody></table>", "caption": "Table 2: Quantitative results (mAP) for Cityscapes \\rightarrow Foggy Cityscapes benchmark.", "list_citation_info": ["[46] Minghao Xu, Hang Wang, Bingbing Ni, Qi Tian, and Wenjun Zhang. Cross-domain detection via graph-induced prototype alignment. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 12355\u201312364, 2020.", "[18] Cheng-Chun Hsu, Yi-Hsuan Tsai, Yen-Yu Lin, and Ming-Hsuan Yang. Every pixel matters: Center-aware feature alignment for domain adaptive object detector. In Proceedings of European Conference on Computer Vision, pages 733\u2013748. Springer, 2020.", "[43] Vibashan Vs, Vikram Gupta, Poojan Oza, Vishwanath A Sindagi, and Vishal M Patel. Mega-cda: Memory guided attention for category-aware unsupervised domain adaptive object detection. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 4516\u20134526, 2021.", "[53] Wenzhang Zhou, Dawei Du, Libo Zhang, Tiejian Luo, and Yanjun Wu. Multi-granularity alignment domain adaptation for object detection. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 9581\u20139590, 2022.", "[36] Farzaneh Rezaeianaran, Rakshith Shetty, Rahaf Aljundi, Daniel Olmeda Reino, Shanshan Zhang, and Bernt Schiele. Seeking similarities over differences: Similarity-based domain alignment for adaptive object detection. In Proceedings of IEEE/CVF International Conference on Computer Vision, pages 9204\u20139213, 2021.", "[25] Wuyang Li, Xinyu Liu, Xiwen Yao, and Yixuan Yuan. Scan: Cross domain object detection with semantic conditioned adaptation. In AAAI, volume 6, page 7, 2022.", "[52] Ganlong Zhao, Guanbin Li, Ruijia Xu, and Liang Lin. Collaborative training between region proposal localization and classification for domain adaptive object detection. In Proceedings of European Conference on Computer Vision, pages 86\u2013102. Springer, 2020.", "[44] Vibashan VS, Poojan Oza, and Vishal M Patel. Instance relation graph guided source-free domain adaptive object detection. arXiv preprint arXiv:2203.15793, 2022.", "[26] Wuyang Li, Xinyu Liu, and Yixuan Yuan. Sigma: Semantic-complete graph matching for domain adaptive object detection. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 5291\u20135300, 2022.", "[22] Congcong Li, Dawei Du, Libo Zhang, Longyin Wen, Tiejian Luo, Yanjun Wu, and Pengfei Zhu. Spatial attention pyramid network for unsupervised domain adaptation. In Proceedings of European Conference on Computer Vision, pages 481\u2013497. Springer, 2020.", "[39] Peng Su, Kun Wang, Xingyu Zeng, Shixiang Tang, Dapeng Chen, Di Qiu, and Xiaogang Wang. Adapting object detectors with conditional domain normalization. In Proceedings of European Conference on Computer Vision, pages 403\u2013419. Springer, 2020.", "[27] Xianfeng Li, Weijie Chen, Di Xie, Shicai Yang, Peng Yuan, Shiliang Pu, and Yueting Zhuang. A free lunch for unsupervised domain adaptive object detection without source data. In Proceedings of Conference on Artificial Intelligence, volume 35, pages 8474\u20138481, 2021.", "[49] Fuxun Yu, Di Wang, Yinpeng Chen, Nikolaos Karianakis, Tong Shen, Pei Yu, Dimitrios Lymberopoulos, Sidi Lu, Weisong Shi, and Xiang Chen. Sc-uda: Style and content gaps aware unsupervised domain adaptation for object detection. In Proceedings of IEEE/CVF Winter Conference on Applications of Computer Vision (WACV), pages 1061\u20131070, 2022."]}, {"table": "<table><tbody><tr><td>Method</td><td>mAP</td></tr><tr><td>CutMix [50]</td><td>49.1</td></tr><tr><td>ConfMix (Vertical Mix)</td><td>53.6</td></tr><tr><td>ConfMix (Horizontal Mix)</td><td>39.6</td></tr><tr><td>ConfMix (2-region Mix)</td><td>41.1</td></tr><tr><td>ConfMix (6-division)</td><td>54.1</td></tr><tr><td>ConfMix (9-division)</td><td>53.5</td></tr><tr><td>ConfMix</td><td>54.7</td></tr></tbody></table>", "caption": "Table 3: Target detection accuracy with various mixing strategies.", "list_citation_info": ["[50] Sangdoo Yun, Dongyoon Han, Seong Joon Oh, Sanghyuk Chun, Junsuk Choe, and Youngjoon Yoo. Cutmix: Regularization strategy to train strong classifiers with localizable features. In Proceedings of IEEE/CVF International Conference on Computer Vision, pages 6023\u20136032, 2019."]}], "citation_info_to_title": {"[53] Wenzhang Zhou, Dawei Du, Libo Zhang, Tiejian Luo, and Yanjun Wu. Multi-granularity alignment domain adaptation for object detection. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 9581\u20139590, 2022.": "Multi-granularity alignment domain adaptation for object detection", "[25] Wuyang Li, Xinyu Liu, Xiwen Yao, and Yixuan Yuan. Scan: Cross domain object detection with semantic conditioned adaptation. In AAAI, volume 6, page 7, 2022.": "Scan: Cross domain object detection with semantic conditioned adaptation", "[52] Ganlong Zhao, Guanbin Li, Ruijia Xu, and Liang Lin. Collaborative training between region proposal localization and classification for domain adaptive object detection. In Proceedings of European Conference on Computer Vision, pages 86\u2013102. Springer, 2020.": "Collaborative training between region proposal localization and classification for domain adaptive object detection", "[44] Vibashan VS, Poojan Oza, and Vishal M Patel. Instance relation graph guided source-free domain adaptive object detection. arXiv preprint arXiv:2203.15793, 2022.": "Instance Relation Graph Guided Source-Free Domain Adaptive Object Detection", "[50] Sangdoo Yun, Dongyoon Han, Seong Joon Oh, Sanghyuk Chun, Junsuk Choe, and Youngjoon Yoo. Cutmix: Regularization strategy to train strong classifiers with localizable features. In Proceedings of IEEE/CVF International Conference on Computer Vision, pages 6023\u20136032, 2019.": "Cutmix: Regularization strategy to train strong classifiers with localizable features", "[36] Farzaneh Rezaeianaran, Rakshith Shetty, Rahaf Aljundi, Daniel Olmeda Reino, Shanshan Zhang, and Bernt Schiele. Seeking similarities over differences: Similarity-based domain alignment for adaptive object detection. In Proceedings of IEEE/CVF International Conference on Computer Vision, pages 9204\u20139213, 2021.": "Seeking similarities over differences: Similarity-based domain alignment for adaptive object detection", "[39] Peng Su, Kun Wang, Xingyu Zeng, Shixiang Tang, Dapeng Chen, Di Qiu, and Xiaogang Wang. Adapting object detectors with conditional domain normalization. In Proceedings of European Conference on Computer Vision, pages 403\u2013419. Springer, 2020.": "Adapting Object Detectors with Conditional Domain Normalization", "[26] Wuyang Li, Xinyu Liu, and Yixuan Yuan. Sigma: Semantic-complete graph matching for domain adaptive object detection. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 5291\u20135300, 2022.": "Sigma: Semantic-complete graph matching for domain adaptive object detection", "[49] Fuxun Yu, Di Wang, Yinpeng Chen, Nikolaos Karianakis, Tong Shen, Pei Yu, Dimitrios Lymberopoulos, Sidi Lu, Weisong Shi, and Xiang Chen. Sc-uda: Style and content gaps aware unsupervised domain adaptation for object detection. In Proceedings of IEEE/CVF Winter Conference on Applications of Computer Vision (WACV), pages 1061\u20131070, 2022.": "Sc-uda: Style and content gaps aware unsupervised domain adaptation for object detection", "[18] Cheng-Chun Hsu, Yi-Hsuan Tsai, Yen-Yu Lin, and Ming-Hsuan Yang. Every pixel matters: Center-aware feature alignment for domain adaptive object detector. In Proceedings of European Conference on Computer Vision, pages 733\u2013748. Springer, 2020.": "Every pixel matters: Center-aware feature alignment for domain adaptive object detector", "[43] Vibashan Vs, Vikram Gupta, Poojan Oza, Vishwanath A Sindagi, and Vishal M Patel. Mega-cda: Memory guided attention for category-aware unsupervised domain adaptive object detection. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 4516\u20134526, 2021.": "Mega-cda: Memory guided attention for category-aware unsupervised domain adaptive object detection", "[22] Congcong Li, Dawei Du, Libo Zhang, Longyin Wen, Tiejian Luo, Yanjun Wu, and Pengfei Zhu. Spatial attention pyramid network for unsupervised domain adaptation. In Proceedings of European Conference on Computer Vision, pages 481\u2013497. Springer, 2020.": "Spatial Attention Pyramid Network for Unsupervised Domain Adaptation", "[27] Xianfeng Li, Weijie Chen, Di Xie, Shicai Yang, Peng Yuan, Shiliang Pu, and Yueting Zhuang. A free lunch for unsupervised domain adaptive object detection without source data. In Proceedings of Conference on Artificial Intelligence, volume 35, pages 8474\u20138481, 2021.": "A free lunch for unsupervised domain adaptive object detection without source data", "[46] Minghao Xu, Hang Wang, Bingbing Ni, Qi Tian, and Wenjun Zhang. Cross-domain detection via graph-induced prototype alignment. In Proceedings of IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 12355\u201312364, 2020.": "Cross-domain detection via graph-induced prototype alignment"}, "source_title_to_arxiv_id": {"Sigma: Semantic-complete graph matching for domain adaptive object detection": "2203.06398", "A free lunch for unsupervised domain adaptive object detection without source data": "2012.05400"}}