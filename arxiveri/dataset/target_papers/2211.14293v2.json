{"title": "RbA: Segmenting Unknown Regions Rejected by All", "abstract": "Standard semantic segmentation models owe their success to curated datasets\nwith a fixed set of semantic categories, without contemplating the possibility\nof identifying unknown objects from novel categories. Existing methods in\noutlier detection suffer from a lack of smoothness and objectness in their\npredictions, due to limitations of the per-pixel classification paradigm.\nFurthermore, additional training for detecting outliers harms the performance\nof known classes. In this paper, we explore another paradigm with region-level\nclassification to better segment unknown objects. We show that the object\nqueries in mask classification tend to behave like one \\vs all classifiers.\nBased on this finding, we propose a novel outlier scoring function called RbA\nby defining the event of being an outlier as being rejected by all known\nclasses. Our extensive experiments show that mask classification improves the\nperformance of the existing outlier detection methods, and the best results are\nachieved with the proposed RbA. We also propose an objective to optimize RbA\nusing minimal outlier supervision. Further fine-tuning with outliers improves\nthe unknown performance, and unlike previous methods, it does not degrade the\ninlier performance.", "authors": ["Nazir Nayal", "M\u0131sra Yavuz", "Jo\u00e3o F. Henriques", "Fatma G\u00fcney"], "published_date": "2022_11_25", "pdf_url": "http://arxiv.org/pdf/2211.14293v2", "list_table_and_caption": [{"table": "<p>MethodOoDExtraAnomaly TrackObstacle TrackDataNet.AP \\uparrowFPR@95 \\downarrowsIoU gt \\uparrowPPV \\uparrowmean F1 \\uparrowAP \\uparrowFPR@95 \\downarrowsIoU gt \\uparrowPPV \\uparrowmean F1 \\uparrowEmb. Density[5]\u2717\u271737.570.833.920.57.90.846.435.62.92.3JSRNet[67]\u2717\u271333.643.920.229.313.728.128.918.624.511.0Road Inpain.[46]\u2717\u2713-----54.147.157.639.536.0Image Resyn.[47]\u2717\u271352.325.939.711.012.537.74.716.620.58.4ObsNet[1]\u2717\u271375.426.744.252.645.1-----NFlowJS[24]\u2717\u271356.934.736.918.014.985.60.445.549.550.4Ours (NLS)\u2717\u271786.115.956.341.442.087.83.347.456.250.4Max. Entropy[42]\u2713\u271785.515.049.239.528.785.10.847.962.648.5DenseHybrid[25]\u2713\u271778.09.854.224.131.187.10.245.750.150.7PEBAL[65]\u2713\u271749.140.838.927.214.55.012.729.97.65.5SynBoost[4]\u2713\u271356.461.934.717.810.071.33.244.341.837.6Ours (NLS)\u2713\u271791.310.757.849.046.691.70.454.359.157.4</p>", "caption": "Table 1: Results on the SMIYC Benchmark. We report results on both the anomaly and the obstacle track. Both tracks cover a wide variety of scenarios and unknown objects. We report both pixel-level (AP, FPR@95) and component-level metrics (sIoU, PPV, mean F1). We show the results with (lower part) and without (upper part) outlier supervision with the best in bold and the second best underlined for each.", "list_citation_info": ["[46] Krzysztof Lis, Sina Honari, P. Fua, and Mathieu Salzmann. Detecting road obstacles by erasing them. arXiv.org, 2012.13633, 2020.", "[5] Hermann Blum, Paul-Edouard Sarlin, Juan I. Nieto, Roland Y. Siegwart, and C\u00e9sar Cadena. The fishyscapes benchmark: Measuring blind spots in semantic segmentation. IJCV, 129:3119\u20133135, 2021.", "[42] Xia Li, Zhisheng Zhong, Jianlong Wu, Yibo Yang, Zhouchen Lin, and Hong Liu. Expectation-maximization attention networks for semantic segmentation. In ICCV, 2019.", "[65] Yu Tian, Yuyuan Liu, Guansong Pang, Fengbei Liu, Yuanhong Chen, and G. Carneiro. Pixel-wise energy-biased abstention learning for anomaly segmentation on complex urban driving scenes. In ECCV, 2022.", "[25] Matej Grci\u0107, Petra Bevandi\u0107, and Sini\u0161a \u0160egvi\u0107. Densehybrid: Hybrid anomaly detection for dense open-set recognition. In ECCV, 2022.", "[67] Tomas Vojir, Tom\u00e1\u0161 \u0160ipka, Rahaf Aljundi, Nikolay Chumerin, Daniel Olmeda Reino, and Jiri Matas. Road anomaly detection by partial image reconstruction with segmentation coupling. In ICCV, 2021.", "[1] Victor Besnier, Andrei Bursuc, David Picard, and Alexandre Briot. Triggering failures: Out-of-distribution detection by learning from local adversarial attacks in semantic segmentation. In ICCV, 2021.", "[4] Giancarlo Di Biase, Hermann Blum, Roland Y. Siegwart, and C\u00e9sar Cadena. Pixel-wise anomaly detection in complex driving scenes. In CVPR, 2021.", "[47] Krzysztof Lis, Krishna Kanth Nakka, Pascal V. Fua, and Mathieu Salzmann. Detecting the unexpected via image resynthesis. In ICCV, 2019.", "[24] Matej Grcic, Petra Bevandi\u2019c, and Sinivsa vSegvi\u2019c. Dense anomaly detection by robust learning on synthetic negative data. arXiv.org, 2112.12833, 2021."]}, {"table": "<table><thead><tr><th rowspan=\"2\">Method</th><th>OoD</th><th>Extra</th><th rowspan=\"2\">mIoU</th><th colspan=\"3\">Road Anomaly</th><th colspan=\"3\">FS LaF</th></tr><tr><th>Data</th><th>Net.</th><th>AUC \\uparrow</th><th>AP \\uparrow</th><th>FPR@95 \\downarrow</th><th>AUC \\uparrow</th><th>AP \\uparrow</th><th>FPR@95 \\downarrow</th></tr></thead><tbody><tr><th>MSP (R101) [34]</th><td>\u2717</td><td>\u2717</td><td>80.3</td><td>73.76</td><td>20.59</td><td>68.44</td><td>86.99</td><td>6.02</td><td>45.63</td></tr><tr><th>Entropy (R101) [34]</th><td>\u2717</td><td>\u2717</td><td>80.3</td><td>75.12</td><td>22.38</td><td>68.15</td><td>88.32</td><td>13.91</td><td>44.85</td></tr><tr><th>Mahalanobis [40]</th><td>\u2717</td><td>\u2717</td><td>80.3</td><td>76.73</td><td>22.85</td><td>59.20</td><td>92.51</td><td>27.83</td><td>30.17</td></tr><tr><th>SML [38]</th><td>\u2717</td><td>\u2717</td><td>80.3</td><td>81.96</td><td>25.82</td><td>49.74</td><td>96.88</td><td>36.55</td><td>14.53</td></tr><tr><th>GMMSeg (SF) [43]</th><td>\u2717</td><td>\u2717</td><td>82.6</td><td>89.37</td><td>57.65</td><td>44.34</td><td>97.83</td><td>50.03</td><td>12.55</td></tr><tr><th>SynthCP [69]</th><td>\u2717</td><td>\u2713</td><td>80.3</td><td>76.08</td><td>24.86</td><td>64.69</td><td>88.34</td><td>6.54</td><td>45.95</td></tr><tr><th>M2F (MaxLogit)</th><td>\u2717</td><td>\u2717</td><td rowspan=\"2\">82.25</td><td>95.86</td><td>77.31</td><td>16.90</td><td>95.69</td><td>58.52</td><td>22.14</td></tr><tr><th>Ours (NLS)</th><td>\u2717</td><td>\u2717</td><td>95.95</td><td>78.47</td><td>12.68</td><td>96.68</td><td>60.68</td><td>13.45</td></tr><tr><th>Maximized Entropy [11]</th><td>\u2713</td><td>\u2717</td><td>-</td><td>-</td><td>-</td><td>-</td><td>93.06</td><td>41.31</td><td>37.69</td></tr><tr><th>PEBAL [65]</th><td>\u2713</td><td>\u2717</td><td>-</td><td>88.85</td><td>44.41</td><td>37.98</td><td>98.52</td><td>64.43</td><td>6.56</td></tr><tr><th>SynBoost (WRN38) [4]</th><td>\u2713</td><td>\u2713</td><td>-</td><td>81.91</td><td>38.21</td><td>64.75</td><td>96.21</td><td>60.58</td><td>31.02</td></tr><tr><th>Ours (NLS)</th><td>\u2713</td><td>\u2717</td><td>82.3</td><td>97.51</td><td>84.12</td><td>9.74</td><td>98.17</td><td>69.37</td><td>10.04</td></tr></tbody></table>", "caption": "Table 2: Results on Road Anomaly and Fishyscapes LaF. We show the results with (lower part) and without (upper part) outlier supervision with the best in bold and the second best underlined for each. We report the results of NLS both with and without outlier supervision. We also show the performance of max logit [33] with the same model. NLS notably improves FPR@95, especially for small objects on FS LaF.", "list_citation_info": ["[65] Yu Tian, Yuyuan Liu, Guansong Pang, Fengbei Liu, Yuanhong Chen, and G. Carneiro. Pixel-wise energy-biased abstention learning for anomaly segmentation on complex urban driving scenes. In ECCV, 2022.", "[38] Sanghun Jung, Jungsoo Lee, Daehoon Gwak, Sungha Choi, and Jaegul Choo. Standardized max logits: A simple yet effective approach for identifying unexpected road obstacles in urban-scene segmentation. In ICCV, 2021.", "[40] Kimin Lee, Kibok Lee, Honglak Lee, and Jinwoo Shin. A simple unified framework for detecting out-of-distribution samples and adversarial attacks. In NeurIPS, 2018.", "[33] Dan Hendrycks, Steven Basart, Mantas Mazeika, Mohammadreza Mostajabi, Jacob Steinhardt, and Dawn Xiaodong Song. Scaling out-of-distribution detection for real-world settings. In ICML, 2022.", "[34] Dan Hendrycks and Kevin Gimpel. A baseline for detecting misclassified and out-of-distribution examples in neural networks. In ICLR, 2017.", "[4] Giancarlo Di Biase, Hermann Blum, Roland Y. Siegwart, and C\u00e9sar Cadena. Pixel-wise anomaly detection in complex driving scenes. In CVPR, 2021.", "[69] Yingda Xia, Yi Zhang, Fengze Liu, Wei Shen, and Alan Yuille. Synthesize then compare: Detecting failures and anomalies for semantic segmentation. In ECCV, 2020.", "[11] Robin Chan, Matthias Rottmann, and Hanno Gottschalk. Entropy maximization and meta classification for out-of-distribution detection in semantic segmentation. In ICCV, 2021.", "[43] Chen Liang, Wenguan Wang, Jiaxu Miao, and Yi Yang. GMMSeg: Gaussian mixture based generative semantic segmentation models. arXiv.org, 2210.02025, 2022."]}, {"table": "<table><thead><tr><th>Model</th><th>Cls.</th><th>Scoring</th><th>mIoU</th><th>AP</th><th>FPR@95</th></tr></thead><tbody><tr><td>PSA [48]</td><td rowspan=\"2\">Pixel</td><td rowspan=\"2\">Max Logit</td><td>86.05</td><td>25.39</td><td>68.56</td></tr><tr><td>Segmenter [63]</td><td>79.14</td><td>51.98</td><td>31.91</td></tr><tr><td rowspan=\"2\">M2F [14]</td><td rowspan=\"2\">Mask</td><td>Max Logit</td><td rowspan=\"2\">82.25</td><td>77.31</td><td>16.90</td></tr><tr><td>NLS</td><td>78.47</td><td>12.68</td></tr></tbody></table>", "caption": "Table 3: Ablation Study on Mask Classification and Scoring. We compare Mask2Former (M2F) [14] to per-pixel segmentation methods (reproduced) [48, 63] to show the effect of mask classification and NLS compared to max logit [33] for scoring.", "list_citation_info": ["[14] Bowen Cheng, Ishan Misra, Alexander G. Schwing, Alexander Kirillov, and Rohit Girdhar. Masked-attention mask transformer for universal image segmentation. In CVPR, 2022.", "[33] Dan Hendrycks, Steven Basart, Mantas Mazeika, Mohammadreza Mostajabi, Jacob Steinhardt, and Dawn Xiaodong Song. Scaling out-of-distribution detection for real-world settings. In ICML, 2022.", "[48] Huajun Liu, Fuqiang Liu, Xinyi Fan, and Dong Huang. Polarized self-attention: Towards high-quality pixel-wise regression. ARXIV, 2107.00782, 2021.", "[63] Robin Strudel, Ricardo Garcia Pinel, Ivan Laptev, and Cordelia Schmid. Segmenter: Transformer for semantic segmentation. In ICCV, 2021."]}, {"table": "<p>MethodOoD DataRetrainingFS Lost&amp;FoundFS StaticAP \\uparrowFPR@95 \\downarrowAP \\uparrowFPR@95 \\downarrowMSP [34]\u2717\u27171.7744.8512.8839.83Entropy [34]\u2717\u27172.9344.8315.4139.75Image Resynthesis [47]\u2717\u27175.7048.0529.6027.13SML [38]\u2717\u271731.6721.9052.0520.05NFlowJS [24]\u2717\u271343.668.6154.6810.00GMMSeg [43]\u2717\u271762.074.0279.5114.69Ours\u2717\u271747.482.3982.136.53Maximized Entropy [11]\u2713\u271729.9635.1486.558.55SynBoost [4]\u2713\u271743.2215.7972.5918.75PEBAL [65]\u2713\u271744.177.5892.381.73DenseHybrid [25]\u2713\u271347.063.9780.235.95Ours\u2713\u271768.207.7597.130.32</p>", "caption": "Table 5: Results on Fishyscapes Benchmark. We show the results with (lower part) and without (upper part) outlier supervision by highlighting the best in bold and the second best underlined for each metric. NLS with outlier supervision significantly improves the AP on both Lost&amp;Found and Static. We achieve the best performance in terms of FPR@95 on the Static while maintaining a comparable performance on the Lost&amp;Found. Without outlier supervision, NLS achieves second best AP in Lost&amp;Found and best in all other metrics.", "list_citation_info": ["[65] Yu Tian, Yuyuan Liu, Guansong Pang, Fengbei Liu, Yuanhong Chen, and G. Carneiro. Pixel-wise energy-biased abstention learning for anomaly segmentation on complex urban driving scenes. In ECCV, 2022.", "[38] Sanghun Jung, Jungsoo Lee, Daehoon Gwak, Sungha Choi, and Jaegul Choo. Standardized max logits: A simple yet effective approach for identifying unexpected road obstacles in urban-scene segmentation. In ICCV, 2021.", "[25] Matej Grci\u0107, Petra Bevandi\u0107, and Sini\u0161a \u0160egvi\u0107. Densehybrid: Hybrid anomaly detection for dense open-set recognition. In ECCV, 2022.", "[34] Dan Hendrycks and Kevin Gimpel. A baseline for detecting misclassified and out-of-distribution examples in neural networks. In ICLR, 2017.", "[4] Giancarlo Di Biase, Hermann Blum, Roland Y. Siegwart, and C\u00e9sar Cadena. Pixel-wise anomaly detection in complex driving scenes. In CVPR, 2021.", "[11] Robin Chan, Matthias Rottmann, and Hanno Gottschalk. Entropy maximization and meta classification for out-of-distribution detection in semantic segmentation. In ICCV, 2021.", "[43] Chen Liang, Wenguan Wang, Jiaxu Miao, and Yi Yang. GMMSeg: Gaussian mixture based generative semantic segmentation models. arXiv.org, 2210.02025, 2022.", "[47] Krzysztof Lis, Krishna Kanth Nakka, Pascal V. Fua, and Mathieu Salzmann. Detecting the unexpected via image resynthesis. In ICCV, 2019.", "[24] Matej Grcic, Petra Bevandi\u2019c, and Sinivsa vSegvi\u2019c. Dense anomaly detection by robust learning on synthetic negative data. arXiv.org, 2112.12833, 2021."]}], "citation_info_to_title": {"[48] Huajun Liu, Fuqiang Liu, Xinyi Fan, and Dong Huang. Polarized self-attention: Towards high-quality pixel-wise regression. ARXIV, 2107.00782, 2021.": "Polarized self-attention: Towards high-quality pixel-wise regression", "[47] Krzysztof Lis, Krishna Kanth Nakka, Pascal V. Fua, and Mathieu Salzmann. Detecting the unexpected via image resynthesis. In ICCV, 2019.": "Detecting the unexpected via image resynthesis", "[69] Yingda Xia, Yi Zhang, Fengze Liu, Wei Shen, and Alan Yuille. Synthesize then compare: Detecting failures and anomalies for semantic segmentation. In ECCV, 2020.": "Synthesize then compare: Detecting failures and anomalies for semantic segmentation", "[63] Robin Strudel, Ricardo Garcia Pinel, Ivan Laptev, and Cordelia Schmid. Segmenter: Transformer for semantic segmentation. In ICCV, 2021.": "Segmenter: Transformer for semantic segmentation", "[33] Dan Hendrycks, Steven Basart, Mantas Mazeika, Mohammadreza Mostajabi, Jacob Steinhardt, and Dawn Xiaodong Song. Scaling out-of-distribution detection for real-world settings. In ICML, 2022.": "Scaling out-of-distribution detection for real-world settings", "[4] Giancarlo Di Biase, Hermann Blum, Roland Y. Siegwart, and C\u00e9sar Cadena. Pixel-wise anomaly detection in complex driving scenes. In CVPR, 2021.": "Pixel-wise anomaly detection in complex driving scenes", "[46] Krzysztof Lis, Sina Honari, P. Fua, and Mathieu Salzmann. Detecting road obstacles by erasing them. arXiv.org, 2012.13633, 2020.": "Detecting road obstacles by erasing them", "[25] Matej Grci\u0107, Petra Bevandi\u0107, and Sini\u0161a \u0160egvi\u0107. Densehybrid: Hybrid anomaly detection for dense open-set recognition. In ECCV, 2022.": "Densehybrid: Hybrid Anomaly Detection for Dense Open-Set Recognition", "[42] Xia Li, Zhisheng Zhong, Jianlong Wu, Yibo Yang, Zhouchen Lin, and Hong Liu. Expectation-maximization attention networks for semantic segmentation. In ICCV, 2019.": "Expectation-Maximization Attention Networks for Semantic Segmentation", "[24] Matej Grcic, Petra Bevandi\u2019c, and Sinivsa vSegvi\u2019c. Dense anomaly detection by robust learning on synthetic negative data. arXiv.org, 2112.12833, 2021.": "Dense anomaly detection by robust learning on synthetic negative data", "[5] Hermann Blum, Paul-Edouard Sarlin, Juan I. Nieto, Roland Y. Siegwart, and C\u00e9sar Cadena. The fishyscapes benchmark: Measuring blind spots in semantic segmentation. IJCV, 129:3119\u20133135, 2021.": "The fishyscapes benchmark: Measuring blind spots in semantic segmentation", "[65] Yu Tian, Yuyuan Liu, Guansong Pang, Fengbei Liu, Yuanhong Chen, and G. Carneiro. Pixel-wise energy-biased abstention learning for anomaly segmentation on complex urban driving scenes. In ECCV, 2022.": "Pixel-wise energy-biased abstention learning for anomaly segmentation on complex urban driving scenes", "[14] Bowen Cheng, Ishan Misra, Alexander G. Schwing, Alexander Kirillov, and Rohit Girdhar. Masked-attention mask transformer for universal image segmentation. In CVPR, 2022.": "Masked-attention mask transformer for universal image segmentation", "[34] Dan Hendrycks and Kevin Gimpel. A baseline for detecting misclassified and out-of-distribution examples in neural networks. In ICLR, 2017.": "A baseline for detecting misclassified and out-of-distribution examples in neural networks", "[1] Victor Besnier, Andrei Bursuc, David Picard, and Alexandre Briot. Triggering failures: Out-of-distribution detection by learning from local adversarial attacks in semantic segmentation. In ICCV, 2021.": "Triggering failures: Out-of-distribution detection by learning from local adversarial attacks in semantic segmentation", "[67] Tomas Vojir, Tom\u00e1\u0161 \u0160ipka, Rahaf Aljundi, Nikolay Chumerin, Daniel Olmeda Reino, and Jiri Matas. Road anomaly detection by partial image reconstruction with segmentation coupling. In ICCV, 2021.": "Road Anomaly Detection by Partial Image Reconstruction with Segmentation Coupling", "[43] Chen Liang, Wenguan Wang, Jiaxu Miao, and Yi Yang. GMMSeg: Gaussian mixture based generative semantic segmentation models. arXiv.org, 2210.02025, 2022.": "GMMSeg: Gaussian mixture based generative semantic segmentation models", "[38] Sanghun Jung, Jungsoo Lee, Daehoon Gwak, Sungha Choi, and Jaegul Choo. Standardized max logits: A simple yet effective approach for identifying unexpected road obstacles in urban-scene segmentation. In ICCV, 2021.": "Standardized Max Logits: A Simple yet Effective Approach for Identifying Unexpected Road Obstacles in Urban-Scene Segmentation", "[40] Kimin Lee, Kibok Lee, Honglak Lee, and Jinwoo Shin. A simple unified framework for detecting out-of-distribution samples and adversarial attacks. In NeurIPS, 2018.": "A simple unified framework for detecting out-of-distribution samples and adversarial attacks", "[11] Robin Chan, Matthias Rottmann, and Hanno Gottschalk. Entropy maximization and meta classification for out-of-distribution detection in semantic segmentation. In ICCV, 2021.": "Entropy Maximization and Meta Classification for Out-of-Distribution Detection in Semantic Segmentation"}, "source_title_to_arxiv_id": {"Standardized Max Logits: A Simple yet Effective Approach for Identifying Unexpected Road Obstacles in Urban-Scene Segmentation": "2107.11264"}}