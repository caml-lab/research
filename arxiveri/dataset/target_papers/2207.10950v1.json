{"title": "Scale dependant layer for self-supervised nuclei encoding", "abstract": "Recent developments in self-supervised learning give us the possibility to\nfurther reduce human intervention in multi-step pipelines where the focus\nevolves around particular objects of interest. In the present paper, the focus\nlays in the nuclei in histopathology images. In particular we aim at extracting\ncellular information in an unsupervised manner for a downstream task. As nuclei\npresent themselves in a variety of sizes, we propose a new Scale-dependant\nconvolutional layer to bypass scaling issues when resizing nuclei. On three\nnuclei datasets, we benchmark the following methods: handcrafted, pre-trained\nResNet, supervised ResNet and self-supervised features. We show that the\nproposed convolution layer boosts performance and that this layer combined with\nBarlows-Twins allows for better nuclei encoding compared to the supervised\nparadigm in the low sample setting and outperforms all other proposed\nunsupervised methods. In addition, we extend the existing TNBC dataset to\nincorporate nuclei class annotation in order to enrich and publicly release a\nsmall sample setting dataset for nuclei segmentation and classification.", "authors": ["Peter Naylor", "Yao-Hung Hubert Tsai", "Marick La\u00e9", "Makoto Yamada"], "published_date": "2022_07_22", "pdf_url": "http://arxiv.org/pdf/2207.10950v1", "list_table_and_caption": [{"table": "<table><thead><tr><th>Dataset</th><th>Nuclei</th><th>Labels</th><th>Organs</th><th>Semi-</th></tr><tr><th></th><th></th><th></th><th></th><th>automatic</th></tr></thead><tbody><tr><td>TNBC [38]</td><td>4,056</td><td>\u2713</td><td>Breast</td><td>\u2717</td></tr><tr><td>CPM-17 [47]</td><td>7,570</td><td>\u2717</td><td>Multiple</td><td>\u2717</td></tr><tr><td>MoNuSeg [29]</td><td>21,623</td><td>\u2717</td><td>Multiple</td><td>\u2717</td></tr><tr><td>CoNSep [15]</td><td>24,319</td><td>\u2713</td><td>Colon</td><td>\u2717</td></tr><tr><td>MoNuSac [48]</td><td>46,909</td><td>\u2713</td><td>Multiple</td><td>\u2717</td></tr><tr><td>PanNuke [13]</td><td>189,744</td><td>\u2713</td><td>Multiple</td><td>\u2713</td></tr><tr><td>NuCLS [2]</td><td>222,396</td><td>\u2713</td><td>Breast</td><td>\u2713</td></tr><tr><td>Lizard [14]</td><td>495,179</td><td>\u2713</td><td>Colon</td><td>\u2713</td></tr></tbody></table>", "caption": "Table 1: Nuclei segmentation datasets.", "list_citation_info": ["[29] Neeraj Kumar, Ruchika Verma, Deepak Anand, Yanning Zhou, Omer Fahri Onder, Efstratios Tsougenis, Hao Chen, Pheng-Ann Heng, Jiahui Li, Zhiqiang Hu, et al. A multi-organ nucleus segmentation challenge. IEEE transactions on medical imaging, 39(5):1380\u20131391, 2019.", "[15] Simon Graham, Quoc Dang Vu, Shan E Ahmed Raza, Ayesha Azam, Yee Wah Tsang, Jin Tae Kwak, and Nasir Rajpoot. Hover-net: Simultaneous segmentation and classification of nuclei in multi-tissue histology images. Medical Image Analysis, 58:101563, 2019.", "[13] Jevgenij Gamper, Navid Alemi Koohbanani, Ksenija Benet, Ali Khuram, and Nasir Rajpoot. Pannuke: an open pan-cancer histology dataset for nuclei instance segmentation and classification. In European congress on digital pathology, pages 11\u201319. Springer, 2019.", "[2] Mohamed Amgad, Lamees A Atteya, Hagar Hussein, Kareem Hosny Mohammed, Ehab Hafiz, Maha AT Elsebaie, Ahmed M Alhusseiny, Mohamed Atef AlMoslemany, Abdelmagid M Elmatboly, Philip A Pappalardo, et al. Nucls: A scalable crowdsourcing, deep learning approach and dataset for nucleus classification, localization and segmentation. arXiv preprint arXiv:2102.09099, 2021.", "[47] Kurc Tahsin, Zhao Tianhao, Gupta Rajarsi, Kalpathy-Cramer Jayashree, Farahani Keyvan, and Saltz Joel. MICCAI 2018 Workshop and Challenges in Computational Precision Medicine, 2018.", "[14] Simon Graham, Mostafa Jahanifar, Ayesha Azam, Mohammed Nimir, Yee-Wah Tsang, Katherine Dodd, Emily Hero, Harvir Sahota, Atisha Tank, Ksenija Benes, et al. Lizard: a large-scale dataset for colonic nuclear instance segmentation and classification. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 684\u2013693, 2021.", "[48] Ruchika Verma, Neeraj Kumar, Abhijeet Patil, Nikhil Cherian Kurian, Swapnil Rane, and Amit Sethi. Multi-organ nuclei segmentation and classification challenge 2020. IEEE transactions on medical imaging, 39(1380-1391):8, 2020.", "[38] Peter Naylor, Marick La\u00e9, Fabien Reyal, and Thomas Walter. Segmentation of nuclei in histopathology images by deep regression of the distance map. IEEE transactions on medical imaging, 38(2):448\u2013459, 2018."]}, {"table": "<table><thead><tr><th>Slide number</th><th>01</th><th>02</th><th>03</th><th>04</th><th>05</th><th>06</th><th>07</th><th>08</th><th>09</th><th>10</th><th>11</th><th>Total</th></tr><tr><th>Number of patches</th><th>7</th><th>3</th><th>5</th><th>8</th><th>4</th><th>3</th><th>3</th><th>4</th><th>6</th><th>4</th><th>3</th><th>50</th></tr></thead><tbody><tr><td>Adipocyte</td><td>0</td><td>1</td><td>0</td><td>32</td><td>0</td><td>0</td><td>0</td><td>0</td><td>5</td><td>1</td><td>0</td><td>39</td></tr><tr><td>Cancerous</td><td>243</td><td>150</td><td>133</td><td>443</td><td>306</td><td>110</td><td>48</td><td>187</td><td>178</td><td>192</td><td>141</td><td>2131</td></tr><tr><td>Endothelial</td><td>12</td><td>0</td><td>0</td><td>7</td><td>0</td><td>3</td><td>6</td><td>35</td><td>3</td><td>7</td><td>8</td><td>81</td></tr><tr><td>Epithelial</td><td>22</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>34</td><td>0</td><td>0</td><td>0</td><td>0</td><td>56</td></tr><tr><td>Fibroblast</td><td>136</td><td>8</td><td>95</td><td>92</td><td>105</td><td>85</td><td>155</td><td>5</td><td>1</td><td>9</td><td>97</td><td>788</td></tr><tr><td>Lympho/Plasmocyte</td><td>43</td><td>29</td><td>58</td><td>20</td><td>8</td><td>6</td><td>307</td><td>212</td><td>103</td><td>105</td><td>6</td><td>897</td></tr><tr><td>Mitosis</td><td>2</td><td>0</td><td>1</td><td>2</td><td>0</td><td>0</td><td>0</td><td>6</td><td>11</td><td>2</td><td>2</td><td>26</td></tr><tr><td>Myoepithelial</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>4</td><td>0</td><td>0</td><td>0</td><td>0</td><td>4</td></tr><tr><td>Necrosis</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td></tr><tr><td>Total</td><td>458</td><td>188</td><td>287</td><td>596</td><td>419</td><td>204</td><td>555</td><td>445</td><td>301</td><td>316</td><td>254</td><td>5150</td></tr></tbody></table>", "caption": "Table 2: Detailed account of nuclei type within each sample of the TNBC [38] dataset.", "list_citation_info": ["[38] Peter Naylor, Marick La\u00e9, Fabien Reyal, and Thomas Walter. Segmentation of nuclei in histopathology images by deep regression of the distance map. IEEE transactions on medical imaging, 38(2):448\u2013459, 2018."]}, {"table": "<table><tbody><tr><th></th><th></th><td colspan=\"2\">TNBC</td><td colspan=\"2\">CoNSep</td><td colspan=\"2\">PanNuke</td></tr><tr><th></th><th>L</th><td colspan=\"2\">7</td><td colspan=\"2\">4</td><td colspan=\"2\">5</td></tr><tr><th></th><th>Training set size</th><td colspan=\"2\">3,259</td><td colspan=\"2\">15,555</td><td colspan=\"2\">122,117</td></tr><tr><th></th><th>Test set size</th><td colspan=\"2\">759</td><td colspan=\"2\">8,777</td><td colspan=\"2\">67,627</td></tr><tr><th></th><th>Accuracy metric</th><td>Linear</td><td>kNN</td><td>Linear</td><td>kNN</td><td>Linear</td><td>kNN</td></tr><tr><th rowspan=\"3\">No training</th><th>Manual</th><td>55.5\\pm 3.7</td><td>55.6\\pm 0.0</td><td>52.8\\pm 10.7</td><td>17.6\\pm 15.2</td><td>43.5\\pm 5.8</td><td>42.4\\pm 0.0</td></tr><tr><th>Pre-trained ResNet</th><td>55.6\\pm 0.0</td><td>51.3\\pm 0.0</td><td>37.1\\pm 1.1</td><td>37.8\\pm 0.0</td><td>42.3\\pm 0.1</td><td>42.4\\pm 0.0</td></tr><tr><th>Pre-trained ResNet + Size</th><td>55.6\\pm 0.1</td><td>20.0\\pm 0.0</td><td>37.1\\pm 1.6</td><td>37.9\\pm 0.0</td><td>42.3\\pm 0.1</td><td>17.1\\pm 0.0</td></tr><tr><th rowspan=\"4\">Supervised</th><th>SRN</th><td>57.3\\pm 1.2</td><td>52.6\\pm 8.2</td><td>73.9\\pm 0.7</td><td>71.3\\pm 1.7</td><td>71.1\\pm 0.4</td><td>64.1\\pm 1.6</td></tr><tr><th>SRN + Size</th><td>58.1\\pm 1.4</td><td>39.0\\pm 3.5</td><td>74.1\\pm 0.8</td><td>58.6\\pm 2.5</td><td>\\mathbf{73.1\\pm 0.3}</td><td>45.3\\pm 2.2</td></tr><tr><th>SRN + SD-CL</th><td>\\mathbf{58.8\\pm 0.9}</td><td>\\mathbf{58.9\\pm 2.3}</td><td>\\mathbf{74.4\\pm 0.7}</td><td>\\mathbf{71.6\\pm 1.5}</td><td>72.2\\pm 0.3</td><td>\\mathbf{64.9\\pm 1.6}</td></tr><tr><th>SRN + SD-CL + Size</th><td>58.4\\pm 0.9</td><td>46.7\\pm 3.4</td><td>74.0\\pm 0.4</td><td>61.4\\pm 2.7</td><td>\\mathbf{73.1\\pm 0.4}</td><td>47.0\\pm 3.1</td></tr><tr><th rowspan=\"8\">Self-supervised</th><th>BT + SRN</th><td>59.6\\pm 1.3</td><td>56.7\\pm 1.4</td><td>66.9\\pm 0.6</td><td>66.1\\pm 0.5</td><td>58.3\\pm 0.3</td><td>57.6\\pm 0.3</td></tr><tr><th>BT + SRN + Size</th><td>63.3\\pm 0.8</td><td>63.7\\pm 0.7</td><td>68.3\\pm 0.8</td><td>65.8\\pm 0.4</td><td>\\mathbf{59.9\\pm 0.3}</td><td>\\mathbf{59.1\\pm 0.2}</td></tr><tr><th>BT + SRN + SD-CL</th><td>61.8\\pm 2.6</td><td>60.4\\pm 2.1</td><td>67.3\\pm 0.9</td><td>\\mathbf{66.7\\pm 0.5}</td><td>58.5\\pm 0.7</td><td>59.0\\pm 0.5</td></tr><tr><th>BT + SRN + SD-CL + Size</th><td>\\mathbf{64.3\\pm 1.1}</td><td>\\mathbf{64.2\\pm 1.4}</td><td>\\mathbf{68.4\\pm 0.5}</td><td>65.7\\pm 0.5</td><td>\\mathbf{59.9\\pm 0.3}</td><td>59.0\\pm 0.2</td></tr><tr><th>MoCo + SRN</th><td>49.9\\pm 7.9</td><td>53.5\\pm 5.7</td><td>36.0\\pm 1.8</td><td>10.8\\pm 5.0</td><td>35.4\\pm 8.0</td><td>37.0\\pm 4.0</td></tr><tr><th>MoCo + SRN + Size</th><td>55.3\\pm 0.3</td><td>39.9\\pm 10.7</td><td>37.3\\pm 0.8</td><td>26.5\\pm 3.9</td><td>40.8\\pm 1.8</td><td>30.6\\pm 4.0</td></tr><tr><th>MoCo + SRN + SD-CL</th><td>55.2\\pm 4.4</td><td>38.6\\pm 8.0</td><td>37.2\\pm 1.5</td><td>26.7\\pm 3.7</td><td>41.2\\pm 1.5</td><td>32.1\\pm 3.9</td></tr><tr><th>MoCo + SRN + SD-CL + Size</th><td>54.7\\pm 2.0</td><td>38.3\\pm 9.5</td><td>37.5\\pm 0.9</td><td>25.8\\pm 4.2</td><td>39.5\\pm 2.3</td><td>31.6\\pm 3.1</td></tr></tbody></table>", "caption": "Table 3: Comparison of different methods for nuclei encoding on TNBC, CoNSep and PanNuke datasets. We bold the best score in its category, self-supervised learning and supervised. Our proposed convolution layer is named SD-CL. SRN is a modified 34-ResNet adapted for small images [22]. MoCo [21] and BT [51] have not yet been applied to nuclei encoding in histopathology images. L is the number of classes, n_{train} and n_{test} are the number of samples in the train and test sets.", "list_citation_info": ["[21] Kaiming He, Haoqi Fan, Yuxin Wu, Saining Xie, and Ross Girshick. Momentum contrast for unsupervised visual representation learning. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 9729\u20139738, 2020.", "[51] Jure Zbontar, Li Jing, Ishan Misra, Yann LeCun, and St\u00e9phane Deny. Barlow twins: Self-supervised learning via redundancy reduction. In International Conference on Machine Learning, pages 12310\u201312320. PMLR, 2021.", "[22] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep residual learning for image recognition. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 770\u2013778, 2016."]}], "citation_info_to_title": {"[51] Jure Zbontar, Li Jing, Ishan Misra, Yann LeCun, and St\u00e9phane Deny. Barlow twins: Self-supervised learning via redundancy reduction. In International Conference on Machine Learning, pages 12310\u201312320. PMLR, 2021.": "Barlow twins: Self-supervised learning via redundancy reduction", "[48] Ruchika Verma, Neeraj Kumar, Abhijeet Patil, Nikhil Cherian Kurian, Swapnil Rane, and Amit Sethi. Multi-organ nuclei segmentation and classification challenge 2020. IEEE transactions on medical imaging, 39(1380-1391):8, 2020.": "Multi-organ nuclei segmentation and classification challenge 2020", "[22] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep residual learning for image recognition. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 770\u2013778, 2016.": "Deep residual learning for image recognition", "[21] Kaiming He, Haoqi Fan, Yuxin Wu, Saining Xie, and Ross Girshick. Momentum contrast for unsupervised visual representation learning. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 9729\u20139738, 2020.": "Momentum contrast for unsupervised visual representation learning", "[47] Kurc Tahsin, Zhao Tianhao, Gupta Rajarsi, Kalpathy-Cramer Jayashree, Farahani Keyvan, and Saltz Joel. MICCAI 2018 Workshop and Challenges in Computational Precision Medicine, 2018.": "MICCAI 2018 Workshop and Challenges in Computational Precision Medicine", "[38] Peter Naylor, Marick La\u00e9, Fabien Reyal, and Thomas Walter. Segmentation of nuclei in histopathology images by deep regression of the distance map. IEEE transactions on medical imaging, 38(2):448\u2013459, 2018.": "Segmentation of nuclei in histopathology images by deep regression of the distance map", "[13] Jevgenij Gamper, Navid Alemi Koohbanani, Ksenija Benet, Ali Khuram, and Nasir Rajpoot. Pannuke: an open pan-cancer histology dataset for nuclei instance segmentation and classification. In European congress on digital pathology, pages 11\u201319. Springer, 2019.": "Pannuke: an open pan-cancer histology dataset for nuclei instance segmentation and classification", "[2] Mohamed Amgad, Lamees A Atteya, Hagar Hussein, Kareem Hosny Mohammed, Ehab Hafiz, Maha AT Elsebaie, Ahmed M Alhusseiny, Mohamed Atef AlMoslemany, Abdelmagid M Elmatboly, Philip A Pappalardo, et al. Nucls: A scalable crowdsourcing, deep learning approach and dataset for nucleus classification, localization and segmentation. arXiv preprint arXiv:2102.09099, 2021.": "Nucls: A scalable crowdsourcing, deep learning approach and dataset for nucleus classification, localization and segmentation", "[29] Neeraj Kumar, Ruchika Verma, Deepak Anand, Yanning Zhou, Omer Fahri Onder, Efstratios Tsougenis, Hao Chen, Pheng-Ann Heng, Jiahui Li, Zhiqiang Hu, et al. A multi-organ nucleus segmentation challenge. IEEE transactions on medical imaging, 39(5):1380\u20131391, 2019.": "A multi-organ nucleus segmentation challenge", "[14] Simon Graham, Mostafa Jahanifar, Ayesha Azam, Mohammed Nimir, Yee-Wah Tsang, Katherine Dodd, Emily Hero, Harvir Sahota, Atisha Tank, Ksenija Benes, et al. Lizard: a large-scale dataset for colonic nuclear instance segmentation and classification. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 684\u2013693, 2021.": "Lizard: a large-scale dataset for colonic nuclear instance segmentation and classification", "[15] Simon Graham, Quoc Dang Vu, Shan E Ahmed Raza, Ayesha Azam, Yee Wah Tsang, Jin Tae Kwak, and Nasir Rajpoot. Hover-net: Simultaneous segmentation and classification of nuclei in multi-tissue histology images. Medical Image Analysis, 58:101563, 2019.": "Hover-net: Simultaneous Segmentation and Classification of Nuclei in Multi-Tissue Histology Images"}, "source_title_to_arxiv_id": {"Nucls: A scalable crowdsourcing, deep learning approach and dataset for nucleus classification, localization and segmentation": "2102.09099"}}