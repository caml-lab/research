{"title": "U-Flow: A U-shaped Normalizing Flow for Anomaly Detection with Unsupervised Threshold", "abstract": "In this work we propose a non-contrastive method for anomaly detection and\nsegmentation in images, that benefits both from a modern machine learning\napproach and a more classic statistical detection theory. The method consists\nof three phases. First, features are extracted using a multi-scale image\nTransformer architecture. Then, these features are fed into a U-shaped\nNormalizing Flow that lays the theoretical foundations for the last phase,\nwhich computes a pixel-level anomaly map, and performs a segmentation based on\nthe a contrario framework. This multiple-hypothesis testing strategy permits to\nderive robust automatic detection thresholds, which are crucial in many\nreal-world applications, where an operational point is needed. The segmentation\nresults are evaluated using the Intersection over Union (IoU) metric; and for\nassessing the generated anomaly maps we report the area under the Receiver\nOperating Characteristic curve (AUROC), and the area under the\nper-region-overlap curve (AUPRO). Extensive experimentation in various datasets\nshows that the proposed approach produces state-of-the-art results for all\nmetrics and all datasets, ranking first in most MvTec-AD categories, with a\nmean pixel-level AUROC of 98.74%. Code and trained models are available at\nhttps:// github.com/mtailanian/uflow.", "authors": ["Mat\u00edas Tailanian", "\u00c1lvaro Pardo", "Pablo Mus\u00e9"], "published_date": "2022_11_22", "pdf_url": "http://arxiv.org/pdf/2211.12353v2", "list_table_and_caption": [{"table": "<table><tbody><tr><td>Category</td><td>PatchSVDD [35]</td><td>PaDiM [4]</td><td>CutPaste [18]</td><td>PatchCore [21]</td><td>FastFlow [36]</td><td>CFlow [12]</td><td>U-Flow (ours)</td></tr><tr><td>Carpet</td><td>(92.90 , 92.60)</td><td>(- , 99.10)</td><td>(100.0 , 98.30)</td><td>(98.70 , 98.90)</td><td>(100.0 , 99.40)</td><td>(100.0 , 99.25)</td><td>(100.0 , 99.42)</td></tr><tr><td>Grid</td><td>(94.60 , 96.20)</td><td>(- , 97.30)</td><td>(96.20 , 97.50)</td><td>(98.20 , 98.70)</td><td>(99.70 , 98.30)</td><td>(97.60 , 98.99)</td><td>(99.75 , 98.49)</td></tr><tr><td>Leather</td><td>(90.90 , 97.40)</td><td>(- , 98.90)</td><td>(95.40 , 99.50)</td><td>(100.0 , 99.30)</td><td>(100.0 , 99.50)</td><td>(97.70 , 99.66)</td><td>(100.0 , 99.59)</td></tr><tr><td>Tile</td><td>(97.80 , 91.40)</td><td>(- , 94.10)</td><td>(100.0 , 90.50)</td><td>(98.70 , 95.60)</td><td>(100.0 , 96.30)</td><td>(98.70 , 98.01)</td><td>(100.0 , 97.54)</td></tr><tr><td>Wood</td><td>(96.50 , 90.80)</td><td>(- , 94.90)</td><td>(99.10 , 95.50)</td><td>(99.20 , 95.00)</td><td>(100.0 , 97.00)</td><td>(99.60 , 96.65)</td><td>(99.91 , 97.49)</td></tr><tr><td>Av. texture</td><td>(94.54 , 93.68)</td><td>(- , 96.86)</td><td>(98.14 , 96.26)</td><td>(98.96 , 97.50)</td><td>(99.94 , 98.10)</td><td>(98.72 , 98.51)</td><td>(99.93 , 98.51)</td></tr><tr><td>Bottle</td><td>(98.60 , 98.10)</td><td>(- , 98.30)</td><td>(99.90 , 97.60)</td><td>(100.0 , 98.60)</td><td>(100.0 , 97.70</td><td>(100.0 , 98.98)</td><td>(100.0 , 98.65)</td></tr><tr><td>Cable</td><td>(90.30 , 96.80)</td><td>(- , 96.70)</td><td>(100.0 , 90.00)</td><td>(99.50 , 98.40)</td><td>(100.0 , 98.40</td><td>(100.0 , 97.64)</td><td>(98.97 , 98.61)</td></tr><tr><td>Capsule</td><td>(76.70 , 95.80)</td><td>(- , 98.50)</td><td>(98.60 , 97.40)</td><td>(98.10 , 98.80)</td><td>(100.0 , 99.10</td><td>(99.30 , 98.98)</td><td>(99.56 , 99.02)</td></tr><tr><td>Hazelnut</td><td>(92.00 , 97.50)</td><td>(- , 98.20)</td><td>(93.30 , 97.30)</td><td>(100.0 , 98.70)</td><td>(100.0 , 99.10)</td><td>(96.80 , 98.89)</td><td>(99.71 , 99.30)</td></tr><tr><td>Metal nut</td><td>(94.00 , 98.00)</td><td>(- , 97.20)</td><td>(86.60 , 93.10)</td><td>(100.0 , 98.40)</td><td>(100.0 , 98.50)</td><td>(91.90 , 98.56)</td><td>(100.0 , 98.82)</td></tr><tr><td>Pill</td><td>(86.10 , 95.10)</td><td>(- , 95.70)</td><td>(99.80 , 95.70)</td><td>(96.60 , 97.10)</td><td>(99.40 , 99.20)</td><td>(99.90 , 98.95)</td><td>(98.80 , 99.35)</td></tr><tr><td>Screw</td><td>(81.30 , 95.70)</td><td>(- , 98.50)</td><td>(90.70 , 96.70)</td><td>(98.10 , 99.40)</td><td>(97.80 , 99.40)</td><td>(99.70 , 98.86)</td><td>(96.31 , 99.49)</td></tr><tr><td>Toothbrush</td><td>(100.0 , 98.10)</td><td>(- , 98.80)</td><td>(97.50 , 98.10)</td><td>(100.0 , 98.70)</td><td>(94.40 , 98.90)</td><td>(95.20 , 98.93)</td><td>(91.39 , 98.79)</td></tr><tr><td>Transistor</td><td>(91.50 , 97.00)</td><td>(- , 97.50)</td><td>(99.80 , 93.00)</td><td>(100.0 , 96.30)</td><td>(99.80 , 97.30)</td><td>(99.10 , 97.99)</td><td>(99.92 , 97.87)</td></tr><tr><td>Zipper</td><td>(97.90 , 95.10)</td><td>(- , 98.50)</td><td>(99.90 ,99.30)</td><td>(98.80 , 98.80)</td><td>(99.50 , 98.70)</td><td>(98.50 , 99.08)</td><td>(98.74 , 98.60)</td></tr><tr><td>Av. objects</td><td>(90.84 , 96.72)</td><td>(- , 97.79)</td><td>(96.61 , 95.82)</td><td>(99.11 , 98.32)</td><td>(99.09 , 98.63)</td><td>(98.04 , 98.69)</td><td>(98.34 , 98.85)</td></tr><tr><td>Av. total</td><td>(92.07 , 95.71)</td><td>(- , 97.48)</td><td>(97.12 , 95.97)</td><td>(99.06 , 98.05)</td><td>(99.37 , 98.45)</td><td>(98.27 , 98.63)</td><td>(98.87 , 98.74)</td></tr></tbody></table>", "caption": "Table 1: ROC-AUC results in the format (image-level, pixel-level). Our methods achieves state-of-the-art performance in both detection (image-level) and localization (pixel-level) metrics, ranking first on the localization task. Due to space constraints, both results had to be condensed in one table, and we excluded comparisons with PADE and PEFM (which were among the least performing ones). Separate localization and detection tables, including these two methods, can be found in the supplementary material.", "list_citation_info": ["[4] Thomas Defard, Aleksandr Setkov, Angelique Loesch, and Romaric Audigier. Padim: a patch distribution modeling framework for anomaly detection and localization. In International Conference on Pattern Recognition, pages 475\u2013489. Springer, 2021.", "[12] Denis Gudovskiy, Shun Ishizaka, and Kazuki Kozuka. Cflow-ad: Real-time unsupervised anomaly detection with localization via conditional normalizing flows. In Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision, pages 98\u2013107, 2022.", "[18] Chun-Liang Li, Kihyuk Sohn, Jinsung Yoon, and Tomas Pfister. Cutpaste: Self-supervised learning for anomaly detection and localization. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 9664\u20139674, 2021.", "[21] Karsten Roth, Latha Pemula, Joaquin Zepeda, Bernhard Sch\u00f6lkopf, Thomas Brox, and Peter Gehler. Towards total recall in industrial anomaly detection. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 14318\u201314328, 2022.", "[36] Jiawei Yu, Ye Zheng, Xiang Wang, Wei Li, Yushuang Wu, Rui Zhao, and Liwei Wu. Fastflow: Unsupervised anomaly detection and localization via 2d normalizing flows. arXiv preprint arXiv:2111.07677, 2021.", "[35] Jihun Yi and Sungroh Yoon. Patch svdd: Patch-level svdd for anomaly detection and segmentation. In Proceedings of the Asian Conference on Computer Vision, 2020."]}], "citation_info_to_title": {"[35] Jihun Yi and Sungroh Yoon. Patch svdd: Patch-level svdd for anomaly detection and segmentation. In Proceedings of the Asian Conference on Computer Vision, 2020.": "Patch svdd: Patch-level svdd for anomaly detection and segmentation", "[18] Chun-Liang Li, Kihyuk Sohn, Jinsung Yoon, and Tomas Pfister. Cutpaste: Self-supervised learning for anomaly detection and localization. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 9664\u20139674, 2021.": "Cutpaste: Self-supervised learning for anomaly detection and localization", "[4] Thomas Defard, Aleksandr Setkov, Angelique Loesch, and Romaric Audigier. Padim: a patch distribution modeling framework for anomaly detection and localization. In International Conference on Pattern Recognition, pages 475\u2013489. Springer, 2021.": "Padim: a patch distribution modeling framework for anomaly detection and localization", "[21] Karsten Roth, Latha Pemula, Joaquin Zepeda, Bernhard Sch\u00f6lkopf, Thomas Brox, and Peter Gehler. Towards total recall in industrial anomaly detection. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 14318\u201314328, 2022.": "Towards total recall in industrial anomaly detection", "[36] Jiawei Yu, Ye Zheng, Xiang Wang, Wei Li, Yushuang Wu, Rui Zhao, and Liwei Wu. Fastflow: Unsupervised anomaly detection and localization via 2d normalizing flows. arXiv preprint arXiv:2111.07677, 2021.": "Fastflow: Unsupervised Anomaly Detection and Localization via 2D Normalizing Flows", "[12] Denis Gudovskiy, Shun Ishizaka, and Kazuki Kozuka. Cflow-ad: Real-time unsupervised anomaly detection with localization via conditional normalizing flows. In Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision, pages 98\u2013107, 2022.": "Cflow-ad: Real-time unsupervised anomaly detection with localization via conditional normalizing flows"}, "source_title_to_arxiv_id": {"Cutpaste: Self-supervised learning for anomaly detection and localization": "2104.04015", "Cflow-ad: Real-time unsupervised anomaly detection with localization via conditional normalizing flows": "2107.12571"}}